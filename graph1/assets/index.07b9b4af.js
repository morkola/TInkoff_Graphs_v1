var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,n)=>{for(var u in n||(n={}))a.call(n,u)&&s(e,u,n[u]);if(t)for(var u of t(n))l.call(n,u)&&s(e,u,n[u]);return e};import{o as u,c as i,r,p as c,a as o,b as d,d as v,e as y,f as p,g as h,h as m,u as f,i as x,t as b,F as g,j as k,k as w,w as S,l as V,v as $,T as C,m as F,n as j,q as M,s as P,x as L,y as O,z as _,A as B,B as q,C as E,D as A,E as D}from"./vendor.65da97c3.js";const T={};T.render=function(e,t){const a=r("router-view");return u(),i(a)};const I=j();c("data-v-543edaaf");const N={class:"graph-wrapper"},z={class:"price"},U={class:"current-price",v:""},R={key:0},Y={key:1},G={key:2},H=M('<div class="axis-x" data-v-543edaaf><div class="x-item" data-v-543edaaf>Янв</div><div class="x-item" data-v-543edaaf>Фев</div><div class="x-item" data-v-543edaaf>Мар</div><div class="x-item" data-v-543edaaf>Апр</div><div class="x-item" data-v-543edaaf>Май</div><div class="x-item" data-v-543edaaf>Июн</div><div class="x-item" data-v-543edaaf>Июл</div><div class="x-item" data-v-543edaaf>Авг</div><div class="x-item" data-v-543edaaf>Сен</div><div class="x-item" data-v-543edaaf>Окт</div><div class="x-item" data-v-543edaaf>Ноя</div><div class="x-item" data-v-543edaaf>Дек</div></div>',1),J={class:"graph-year"},K={class:"footer"},Q={class:"container"},W={key:0,class:"price"},X={class:"current-price"},Z={key:2,style:{position:"relative"}};o();const ee={expose:[],props:{points:Array,duration:Number,id:String,currency:String,year:Number},setup(e){const t=e,{points:a,duration:l}=t;d(400),d(400),d(0),d(0);const s=d(0),r=v({width:1e3,height:400,x:-30,y:0}),c=y((()=>l/a.length));let o=v({purchases:[],startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,values:y((()=>[...a].map((e=>e[1])))),maxValue:y((()=>[...a].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:y((()=>[...a].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:y((()=>[...a].length))}),j=y((()=>[{x:0,value:o.minValue,y:o.minValue&&o.maxValue?le(0,o.minValue).y:0},{x:0,value:o.maxValue,y:o.minValue&&o.maxValue?le(0,o.maxValue).y:0},{x:0,value:o.minValue&&o.maxValue?o.minValue+(o.maxValue-o.minValue)/2:0,y:o.minValue&&o.maxValue?le(0,o.minValue+(o.maxValue-o.minValue)/2).y:0}]));const M=y((()=>a.reduce(((e,t)=>(e.push(le(t[0],t[1])),e)),[]))),P=y((()=>M.value.reduce(((e,t,a,l)=>{if(a){const s=l[a-1],n=t;e.push(`M${s.x} ${s.y}, ${n.x} ${n.y}`)}return e}),[]))),L=y((()=>M.value.reduce(((e,t,a,l)=>{if(a&&a<=s.value){const s=l[a-1],n=t;e+=`${s.x} ${s.y}, ${n.x} ${n.y} `}return e}),"")));y((()=>[...P.value].filter(((e,t)=>t<s.value))));const O=y((()=>o.purchases.reduce(((e,t)=>(t.buy&&e.push(n({type:"buy",value:t.buy},le(t.buyPoint.x,t.buyPoint.y))),t.sell&&e.push(n({type:"sell",value:t.sell},le(t.sellPoint.x,t.sellPoint.y))),e)),[]))),_=y((()=>a[s.value]));y((()=>+(s.value>0?a[s.value][1]-a[s.value-1][1]:0).toFixed(2)));const B=d(!1),q=y((()=>o.purchases&&o.purchases.length?o.purchases[o.purchases.length-1]:null)),E=y((()=>{if(q.value&&q.value.sell){const e=+o.startSum.replace(/[^0-9]/gi,""),t=q.value.buy,a=q.value.sell,l=Math.floor(e/t),s=e-l*t,n=t*l,u=a*l;return{sum:u+s,value:u-n,perc:u?100*(u-n+s)/u:0}}return null}));function A(e){e+1<o.steps?s.value=e+1:(B.value=!1,null==o.selled&&null!=o.saved&&ae())}const D=d(null);function T(){o.isStarted=!0,B.value=!0,ee()}function ee(){A(s.value),B.value&&setTimeout((()=>{ee()}),1e3*c.value)}function te(){o.saved=a[s.value];const e=+o.startSum.replace(/[^0-9]/gi,""),t=o.saved[1];o.savedNum=Math.floor(e/t),o.purchases.push({buy:o.saved[1],buyPoint:{x:o.saved[0],y:o.saved[1]},sell:null,sellPoint:null})}function ae(){o.selled=a[s.value],o.purchases[o.purchases.length-1].sell=o.selled[1],o.purchases[o.purchases.length-1].sellPoint={x:o.selled[0],y:o.selled[1]},o.saved=null,o.selled=null}function le(e,t){const a=(r.width-35-0)/o.steps,l=(r.height-80-20)/(o.maxValue-o.minValue);return{x:0+e*a,y:r.height-40-t*l+o.minValue*l}}function se(){const{width:e,height:t}=D.value.getBoundingClientRect();r.width=Math.round(e),r.height=Math.round(t)}return p((()=>{const{width:e,height:t}=D.value.getBoundingClientRect();s.value=0,r.width=Math.round(e),r.height=Math.round(t),window.addEventListener("resize",se)})),h((()=>{window.removeEventListener("resize",se)})),(a,l)=>(u(),i(g,null,[m("div",N,[m("div",z,[m("div",U,[f(q)?x("",!0):(u(),i("span",R," ")),f(q)&&null==f(q).sell?(u(),i("span",Y,b((+f(q).buy.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):x("",!0),f(q)&&null!=f(q).sell?(u(),i("span",G,b((+f(q).sell.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):x("",!0)])]),m("div",{ref:D,class:"graph-container"},[H,(u(),i("svg",{class:"graph",width:f(r).width+10,height:f(r).height,viewBox:`${f(r).x} ${f(r).y} ${f(r).width+10} ${f(r).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${f(r).height}, ${f(r).width} ${f(r).height}`},null,8,["d"]),(u(!0),i(g,null,k(f(j),(e=>(u(),i(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${f(r).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},b(e.value<1?(+e.value.toFixed(2)).toLocaleString("ru"):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${f(r).height}, 0 0`},null,8,["d"]),m("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:f(L)},null,8,["points"]),(u(!0),i(g,null,k(f(O),((e,t)=>(u(),i(g,{key:t},[m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:f(r).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("circle",{cx:e.x,cy:e.y,r:"5",class:["point-circle",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},null,10,["cx","cy"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:["point-text",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},b((+e.value.toFixed(2)).toLocaleString("ru")),11,["x","y"])],64)))),128))],8,["width","height","viewBox"]))],512)]),m("div",J,b(e.year)+" год",1),m("div",K,[m("div",Q,[f(E)?(u(),i("div",W,[m("div",X,b((+f(E).sum.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1),f(E)?(u(),i("div",{key:0,class:["current-diff",{up:f(E).value>0,down:f(E).value<0}]},[f(E).value?(u(),i("div",{key:0,class:["arrow",{up:f(E).value>0,down:f(E).value<0}]},null,2)):x("",!0),w(" "+b((+Math.abs(f(E).value).toFixed(2)).toLocaleString("ru"))+" "+b(t.currency?" "+t.currency:" ₽")+" ("+b((+Math.abs(f(E).perc).toFixed(2)).toLocaleString("ru"))+"%) ",1)],2)):x("",!0)])):x("",!0),f(o).isStarted?x("",!0):(u(),i("form",{key:1,onSubmit:S(T,["prevent"]),style:{position:"relative"}},[V(m("input",{type:"text",class:"text-input","onUpdate:modelValue":l[1]||(l[1]=e=>f(o).startSum=e),placeholder:"Ваша сумма "+(t.currency?" "+t.currency:" ₽")},null,8,["placeholder"]),[[$,f(o).startSum]]),m("button",{disabled:!(f(o).startSum&&f(o).startSum>=f(o).minValue),type:"submit",class:"button"}," Старт ",8,["disabled"])],40,["onSubmit"])),B.value&&f(o).isStarted?(u(),i("div",Z,[m(C,{name:"fade",mode:"in-out",appear:""},{default:I((()=>[V(m("button",{class:"button",style:{background:"green"},onClick:te,disabled:f(o).startSum<f(_)[1]}," Купить ",8,["disabled"]),[[F,B.value&&!f(o).saved]])])),_:1}),V(m("button",{class:"button",style:{background:"red"},onClick:ae}," Продать ",512),[[F,B.value&&f(o).saved&&!f(E)]])])):x("",!0)])])],64))},__scopeId:"data-v-543edaaf"};const te=j();c("data-v-2c57e6fd");const ae={class:"app-container"},le={class:"container"},se={key:0,class:"title-container"},ne={class:"subtitle"},ue={class:"container"};o();const ie={expose:[],setup(e){const t=O(),a=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let l=[[0,10],[10,30],[20,20],[30,50],[40,20]];l=new Array(365),l.fill([0,0]);let s=d(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),s=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];a.points.push(...l.map(((e,t,l)=>{const u=null!=s[t]?s[t]:n;return n=u,[t,a.isBucks?u*a.bucksCourse:u]})))}async function c(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=e.time||40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(s.value=e.sources.find((e=>e.file===t.params.id)),!s.value)return Promise.reject();a.currency=s.value.currency,a.isBucks=s.value.isBucks,await n(s.value.file)}catch(e){console.log(e)}}return P((()=>{c()})),L((()=>t.params.id),(e=>{a.points=[],_((()=>{c()}))})),(e,l)=>{const n=r("router-link");return u(),i(C,{name:"fade",appear:""},{default:te((()=>[m("div",ae,[m("header",{class:"header",style:{background:f(s)?f(s).color:void 0}},[m("div",le,[m(n,{class:"back-btn",to:f(t).query.from||"/"},null,8,["to"]),f(s)?(u(),i("div",se,[m("div",null,b(f(s).title),1),m("div",ne,b(f(s).short),1)])):x("",!0)])],4),m("div",ue,[f(a).points&&f(a).points.length?(u(),i(ee,{points:f(a).points,duration:f(a).duration,id:f(t).params.id,key:f(t).params.id,currency:f(a).currency,year:f(s).year},null,8,["points","duration","id","currency","year"])):x("",!0)])])])),_:1})}},__scopeId:"data-v-2c57e6fd"};const re=j();c("data-v-0bc6bf85");const ce={class:"container"},oe=m("h1",{class:"h1"},"Выберите компанию",-1),de={class:"items is-full"},ve=m("h1",{class:"h1"},"Выберите компании",-1),ye={key:0,class:"items"};o();const pe={expose:[],setup(e){const t=O(),a=q();const l=v({items:[],isFullscreen:B.isFullscreen,selected:[],preSelected:[]}),s=y((()=>l.selected&&l.selected.length>0)),n=y((()=>l.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),c=y((()=>l.items.filter((e=>-1!==l.selected.indexOf(e.file)))));function o(){a.push({query:{selected:l.preSelected}}),l.selected=l.preSelected,l.preSelected=[]}function d(){B.isEnabled&&(l.isFullscreen=!B.isFullscreen,B.toggle())}return P((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();l.items=e.sources,l.selected=t.query.selected||[]})),L((()=>t.query.selected),(e=>{l.selected=t.query.selected||[]})),(e,a)=>{const v=r("router-link");return u(),i(C,{name:"fade",appear:""},{default:re((()=>[m("div",ce,[f(s)?(u(),i(v,{key:0,class:"back-btn",to:f(t).query.from||"/"},null,8,["to"])):x("",!0),m("button",{class:["fullscreen-icon",{off:f(l).isFullscreen}],onClick:d},null,2),f(s)&&f(l).items?(u(),i(g,{key:1},[oe,m("div",de,[(u(!0),i(g,null,k(f(c),(e=>(u(),i("div",{class:"item",style:{background:e.color},key:e.file},[m(v,{to:{path:`/${e.file}`,query:{from:f(t).fullPath}}},{default:re((()=>[w(b(e.title)+" "+b(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(u(),i(g,{key:2},[ve,f(l).items?(u(),i("div",ye,[(u(!0),i(g,null,k(f(l).items,(e=>(u(),i("div",{class:["item",{selected:f(n)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:t=>function(e){-1===l.preSelected.indexOf(e)?l.preSelected.push(e):l.preSelected=l.preSelected.filter((t=>t!==e))}(e.file)},b(e.title)+" "+b(e.year),9,["onClick"])],6)))),128))])):x("",!0),f(s)?x("",!0):(u(),i("button",{key:1,type:"button",disabled:!f(l).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-0bc6bf85"},he=E({routes:[{path:"",component:pe},{path:"/:id",component:ie}],history:A()}),me=D(T);me.use(he),me.mount("#app");
