var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,n)=>{for(var u in n||(n={}))a.call(n,u)&&l(e,u,n[u]);if(t)for(var u of t(n))s.call(n,u)&&l(e,u,n[u]);return e};import{o as u,c as i,r,p as c,a as o,b as d,d as v,e as y,f as p,g as h,h as m,u as x,i as f,t as b,F as g,j as k,k as w,w as S,l as V,v as $,m as C,n as P,q as F,s as M,x as j,T as L,y as O,z as B,A as _,B as q,C as E,D as T,E as A}from"./vendor.4efa5d83.js";const D={};D.render=function(e,t){const a=r("router-view");return u(),i(a)};c("data-v-5753c567");const I={class:"graph-wrapper"},N={class:"price"},z={class:"current-price",v:""},U={key:0},R={key:1},Y={key:2},G=P('<div class="axis-x" data-v-5753c567><div class="x-item" data-v-5753c567>Янв</div><div class="x-item" data-v-5753c567>Фев</div><div class="x-item" data-v-5753c567>Мар</div><div class="x-item" data-v-5753c567>Апр</div><div class="x-item" data-v-5753c567>Май</div><div class="x-item" data-v-5753c567>Июн</div><div class="x-item" data-v-5753c567>Июл</div><div class="x-item" data-v-5753c567>Авг</div><div class="x-item" data-v-5753c567>Сен</div><div class="x-item" data-v-5753c567>Окт</div><div class="x-item" data-v-5753c567>Ноя</div><div class="x-item" data-v-5753c567>Дек</div></div>',1),H={class:"graph-year"},J={class:"footer"},K={class:"container"},Q={key:0,class:"price"},W={class:"current-price"},X={key:2,style:{position:"relative"}};o();const Z={expose:[],props:{points:Array,duration:Number,id:String,currency:String,year:Number},setup(e){const t=e,{points:a,duration:s}=t;d(400),d(400),d(0),d(0);const l=d(0),r=v({width:1e3,height:400,x:-30,y:0}),c=y((()=>s/a.length));let o=v({purchases:[],startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,isPause:!1,timeout:null,values:y((()=>[...a].map((e=>e[1])))),maxValue:y((()=>[...a].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:y((()=>[...a].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:y((()=>[...a].length))}),P=y((()=>[{x:0,value:o.minValue,y:o.minValue&&o.maxValue?te(0,o.minValue).y:0},{x:0,value:o.maxValue,y:o.minValue&&o.maxValue?te(0,o.maxValue).y:0},{x:0,value:o.minValue&&o.maxValue?o.minValue+(o.maxValue-o.minValue)/2:0,y:o.minValue&&o.maxValue?te(0,o.minValue+(o.maxValue-o.minValue)/2).y:0}]));const F=y((()=>a.reduce(((e,t)=>(e.push(te(t[0],t[1])),e)),[]))),M=y((()=>F.value.reduce(((e,t,a,s)=>{if(a){const l=s[a-1],n=t;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),j=y((()=>{const e=F.value[0],t=F.value[l.value];return F.value.reduce(((a,s,n,u)=>(0===n?a+=`M${e.x},${e.y}`:n<=l.value?a+=` L${s.x},${s.y}`:a+=` L${t.x},${t.y}`,a)),"")}));y((()=>[...M.value].filter(((e,t)=>t<l.value))));const L=y((()=>o.purchases.reduce(((e,t)=>(t.buy&&e.push(n({type:"buy",value:t.buy},te(t.buyPoint.x,t.buyPoint.y))),t.sell&&e.push(n({type:"sell",value:t.sell},te(t.sellPoint.x,t.sellPoint.y))),e)),[]))),O=y((()=>a[l.value]));y((()=>+(l.value>0?a[l.value][1]-a[l.value-1][1]:0).toFixed(2)));const B=d(!1),_=y((()=>o.purchases&&o.purchases.length?o.purchases[o.purchases.length-1]:null)),q=y((()=>{if(_.value&&_.value.sell){const e=+o.startSum.replace(/[^0-9]/gi,""),t=_.value.buy,a=_.value.sell,s=Math.floor(e/t),l=e-s*t,n=t*s,u=a*s;return{sum:u+l,value:u-n,perc:u?100*(u-n+l)/u:0}}return null}));const E=d(null);function T(){clearTimeout(o.timeout),B.value=!1}function A(){clearTimeout(o.timeout),o.isStarted=!0,B.value=!0,o.isPause=!1,D()}function D(){var e;(e=l.value)+1<o.steps?l.value=e+1:(null==o.selled&&null!=o.saved&&ee(),T()),B.value&&(o.timeout=setTimeout((()=>{D()}),1e3*c.value))}function Z(){o.saved=a[l.value];const e=+o.startSum.replace(/[^0-9]/gi,""),t=o.saved[1];o.savedNum=Math.floor(e/t),o.purchases.push({buy:o.saved[1],buyPoint:{x:o.saved[0],y:o.saved[1]},sell:null,sellPoint:null}),T(),o.isPause=!0}function ee(){o.selled=a[l.value],o.purchases[o.purchases.length-1].sell=o.selled[1],o.purchases[o.purchases.length-1].sellPoint={x:o.selled[0],y:o.selled[1]},o.saved=null,o.selled=null}function te(e,t){const a=(r.width-35-0)/o.steps,s=(r.height-80-20)/(o.maxValue-o.minValue);return{x:0+e*a,y:r.height-40-t*s+o.minValue*s}}function ae(){const{width:e,height:t}=E.value.getBoundingClientRect();r.width=Math.round(e),r.height=Math.round(t)}return p((()=>{const{width:e,height:t}=E.value.getBoundingClientRect();l.value=0,r.width=Math.round(e),r.height=Math.round(t),window.addEventListener("resize",ae)})),h((()=>{window.removeEventListener("resize",ae)})),(a,s)=>(u(),i(g,null,[m("div",I,[m("div",N,[m("div",z,[x(_)?f("",!0):(u(),i("span",U," ")),x(_)&&null==x(_).sell?(u(),i("span",R,b((+x(_).buy.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):f("",!0),x(_)&&null!=x(_).sell?(u(),i("span",Y,b((+x(_).sell.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):f("",!0)])]),m("div",{ref:E,class:"graph-container"},[G,(u(),i("svg",{class:"graph",width:x(r).width+10,height:x(r).height,viewBox:`${x(r).x} ${x(r).y} ${x(r).width+10} ${x(r).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${x(r).height}, ${x(r).width} ${x(r).height}`},null,8,["d"]),(u(!0),i(g,null,k(x(P),(e=>(u(),i(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${x(r).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},b(e.value<1?(+e.value.toFixed(2)).toLocaleString("ru"):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${x(r).height}, 0 0`},null,8,["d"]),(u(!0),i(g,null,k(x(L),((e,t)=>(u(),i(g,{key:t},[m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:x(r).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"])],64)))),128)),m("path",{class:["line-path",{"is-animate":B.value}],style:{transition:`${x(c)}s`},"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",d:x(j)},null,14,["d"]),(u(!0),i(g,null,k(x(L),((e,t)=>(u(),i(g,{key:t},[m("circle",{cx:e.x,cy:e.y,r:"5",class:["point-circle",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},null,10,["cx","cy"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:["point-text",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},b((+e.value.toFixed(2)).toLocaleString("ru")),11,["x","y"])],64)))),128))],8,["width","height","viewBox"]))],512)]),m("div",H,b(e.year)+" год",1),m("div",J,[m("div",K,[x(q)?(u(),i("div",Q,[m("div",W,b((+x(q).sum.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1),x(q)?(u(),i("div",{key:0,class:["current-diff",{up:x(q).value>0,down:x(q).value<0}]},[x(q).value?(u(),i("div",{key:0,class:["arrow",{up:x(q).value>0,down:x(q).value<0}]},null,2)):f("",!0),w(" "+b((+Math.abs(x(q).value).toFixed(2)).toLocaleString("ru"))+" "+b(t.currency?" "+t.currency:" ₽")+" ("+b((+Math.abs(x(q).perc).toFixed(2)).toLocaleString("ru"))+"%) ",1)],2)):f("",!0)])):f("",!0),x(o).isStarted?f("",!0):(u(),i("form",{key:1,onSubmit:S(A,["prevent"]),style:{position:"relative"}},[V(m("input",{type:"text",class:"text-input","onUpdate:modelValue":s[1]||(s[1]=e=>x(o).startSum=e),placeholder:"Ваша сумма "+(t.currency?" "+t.currency:" ₽")},null,8,["placeholder"]),[[$,x(o).startSum]]),m("button",{disabled:!(x(o).startSum&&x(o).startSum>=x(o).minValue),type:"submit",class:"button fade-animation"}," Старт ",8,["disabled"])],40,["onSubmit"])),V(m("button",{class:"button fade-animation",style:{background:"green"},onClick:A}," Продолжить ",512),[[C,x(o).isPause]]),B.value&&x(o).isStarted?(u(),i("div",X,[V(m("button",{class:"button fade-animation",style:{background:"green"},onClick:Z,disabled:x(o).startSum<x(O)[1]}," Купить ",8,["disabled"]),[[C,B.value&&!x(o).saved]]),V(m("button",{class:"button fade-animation",style:{background:"red"},onClick:ee}," Продать ",512),[[C,B.value&&x(o).saved&&!x(q)]])])):f("",!0)])])],64))},__scopeId:"data-v-5753c567"};const ee=O();c("data-v-2c57e6fd");const te={class:"app-container"},ae={class:"container"},se={key:0,class:"title-container"},le={class:"subtitle"},ne={class:"container"};o();const ue={expose:[],setup(e){const t=j(),a=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=d(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),l=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];a.points.push(...s.map(((e,t,s)=>{const u=null!=l[t]?l[t]:n;return n=u,[t,a.isBucks?u*a.bucksCourse:u]})))}async function c(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=e.time||40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===t.params.id)),!l.value)return Promise.reject();a.currency=l.value.currency,a.isBucks=l.value.isBucks,await n(l.value.file)}catch(e){console.log(e)}}return F((()=>{c()})),M((()=>t.params.id),(e=>{a.points=[],B((()=>{c()}))})),(e,s)=>{const n=r("router-link");return u(),i(L,{name:"fade",appear:""},{default:ee((()=>[m("div",te,[m("header",{class:"header",style:{background:x(l)?x(l).color:void 0}},[m("div",ae,[m(n,{class:"back-btn",to:x(t).query.from||"/"},null,8,["to"]),x(l)?(u(),i("div",se,[m("div",null,b(x(l).title),1),m("div",le,b(x(l).short),1)])):f("",!0)])],4),m("div",ne,[x(a).points&&x(a).points.length?(u(),i(Z,{points:x(a).points,duration:x(a).duration,id:x(t).params.id,key:x(t).params.id,currency:x(a).currency,year:x(l).year},null,8,["points","duration","id","currency","year"])):f("",!0)])])])),_:1})}},__scopeId:"data-v-2c57e6fd"};const ie=O();c("data-v-0bc6bf85");const re={class:"container"},ce=m("h1",{class:"h1"},"Выберите компанию",-1),oe={class:"items is-full"},de=m("h1",{class:"h1"},"Выберите компании",-1),ve={key:0,class:"items"};o();const ye={expose:[],setup(e){const t=j(),a=q();const s=v({items:[],isFullscreen:_.isFullscreen,selected:[],preSelected:[]}),l=y((()=>s.selected&&s.selected.length>0)),n=y((()=>s.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),c=y((()=>s.items.filter((e=>-1!==s.selected.indexOf(e.file)))));function o(){a.push({query:{selected:s.preSelected}}),s.selected=s.preSelected,s.preSelected=[]}function d(){_.isEnabled&&(s.isFullscreen=!_.isFullscreen,_.toggle())}return F((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();s.items=e.sources,s.selected=t.query.selected||[]})),M((()=>t.query.selected),(e=>{s.selected=t.query.selected||[]})),(e,a)=>{const v=r("router-link");return u(),i(L,{name:"fade",appear:""},{default:ie((()=>[m("div",re,[x(l)?(u(),i(v,{key:0,class:"back-btn",to:x(t).query.from||"/"},null,8,["to"])):f("",!0),m("button",{class:["fullscreen-icon",{off:x(s).isFullscreen}],onClick:d},null,2),x(l)&&x(s).items?(u(),i(g,{key:1},[ce,m("div",oe,[(u(!0),i(g,null,k(x(c),(e=>(u(),i("div",{class:"item",style:{background:e.color},key:e.file},[m(v,{to:{path:`/${e.file}`,query:{from:x(t).fullPath}}},{default:ie((()=>[w(b(e.title)+" "+b(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(u(),i(g,{key:2},[de,x(s).items?(u(),i("div",ve,[(u(!0),i(g,null,k(x(s).items,(e=>(u(),i("div",{class:["item",{selected:x(n)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:t=>function(e){-1===s.preSelected.indexOf(e)?s.preSelected.push(e):s.preSelected=s.preSelected.filter((t=>t!==e))}(e.file)},b(e.title)+" "+b(e.year),9,["onClick"])],6)))),128))])):f("",!0),x(l)?f("",!0):(u(),i("button",{key:1,type:"button",disabled:!x(s).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-0bc6bf85"},pe=E({routes:[{path:"",component:ye},{path:"/:id",component:ue}],history:T()}),he=A(D);he.use(pe),he.mount("#app");
