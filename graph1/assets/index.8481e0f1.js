var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,n)=>{for(var u in n||(n={}))a.call(n,u)&&l(e,u,n[u]);if(t)for(var u of t(n))s.call(n,u)&&l(e,u,n[u]);return e};import{o as u,c as i,r,p as c,a as o,b as d,d as v,e as y,f as p,g as h,h as m,u as f,i as x,t as b,F as g,j as k,k as w,w as S,l as V,v as $,m as P,n as C,q as F,s as L,x as M,T as j,y as O,z as B,A as E,B as _,C as q,D,E as T}from"./vendor.4efa5d83.js";const A={};A.render=function(e,t){const a=r("router-view");return u(),i(a)};c("data-v-97a38fea");const I={class:"graph-wrapper"},N={class:"price"},z={class:"current-price",v:""},U={key:0},R={key:1},Y={key:2},K=C('<div class="axis-x" data-v-97a38fea><div class="x-item" data-v-97a38fea>Янв</div><div class="x-item" data-v-97a38fea>Фев</div><div class="x-item" data-v-97a38fea>Мар</div><div class="x-item" data-v-97a38fea>Апр</div><div class="x-item" data-v-97a38fea>Май</div><div class="x-item" data-v-97a38fea>Июн</div><div class="x-item" data-v-97a38fea>Июл</div><div class="x-item" data-v-97a38fea>Авг</div><div class="x-item" data-v-97a38fea>Сен</div><div class="x-item" data-v-97a38fea>Окт</div><div class="x-item" data-v-97a38fea>Ноя</div><div class="x-item" data-v-97a38fea>Дек</div></div>',1),G={class:"graph-year"},H={class:"footer"},J={class:"container"},Q={key:0,class:"price"},W={class:"current-price"},X={key:2,style:{position:"relative"}};o();const Z={expose:[],props:{points:Array,duration:Number,id:String,currency:String,year:Number},setup(e){const t=e,{points:a,duration:s}=t;d(400),d(400),d(0),d(0);const l=d(0),r=v({width:1e3,height:400,x:-30,y:0}),c=y((()=>s/a.length));let o=v({purchases:[],startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,isPause:!1,timeout:null,values:y((()=>[...a].map((e=>e[1])))),maxValue:y((()=>[...a].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:y((()=>[...a].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:y((()=>[...a].length))}),C=y((()=>[{x:0,value:o.minValue,y:o.minValue&&o.maxValue?se(0,o.minValue).y:0},{x:0,value:o.maxValue,y:o.minValue&&o.maxValue?se(0,o.maxValue).y:0},{x:0,value:o.minValue&&o.maxValue?o.minValue+(o.maxValue-o.minValue)/2:0,y:o.minValue&&o.maxValue?se(0,o.minValue+(o.maxValue-o.minValue)/2).y:0}]));const F=y((()=>a.reduce(((e,t)=>(e.push(se(t[0],t[1])),e)),[]))),L=y((()=>F.value.reduce(((e,t,a,s)=>{if(a){const l=s[a-1],n=t;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),M=y((()=>{const e=F.value[0],t=F.value[l.value];return F.value.reduce(((a,s,n,u)=>(0===n?a+=`M${e.x},${e.y}`:n<=l.value?a+=` L${s.x},${s.y}`:a+=` L${t.x},${t.y}`,a)),"")}));y((()=>[...L.value].filter(((e,t)=>t<l.value))));const j=y((()=>o.purchases.reduce(((e,t)=>(t.buy&&e.push(n({type:"buy",value:t.buy},se(t.buyPoint.x,t.buyPoint.y))),t.sell&&e.push(n({type:"sell",value:t.sell},se(t.sellPoint.x,t.sellPoint.y))),e)),[]))),O=y((()=>a[l.value]));y((()=>+(l.value>0?a[l.value][1]-a[l.value-1][1]:0).toFixed(2)));const B=d(!1),E=y((()=>o.purchases&&o.purchases.length?o.purchases[o.purchases.length-1]:null)),_=y((()=>{if(E.value&&E.value.sell){const e=+o.startSum.replace(/[^0-9]/gi,""),t=E.value.buy,a=E.value.sell,s=Math.floor(e/t),l=e-s*t,n=t*s,u=a*s;return{sum:u+l,value:u-n,perc:u?100*(u-n+l)/u:0}}return null}));const q=d(null);function D(){clearTimeout(o.timeout),B.value=!1}function T(){D(),o.isPause=!0}function A(){clearTimeout(o.timeout),o.isStarted=!0,B.value=!0,o.isPause=!1,Z()}function Z(){var e;(e=l.value)+1<o.steps?l.value=e+1:(null==o.selled&&null!=o.saved&&te(),D()),B.value&&(o.timeout=setTimeout((()=>{Z()}),1e3*c.value))}function ee(){o.saved=a[l.value];const e=+o.startSum.replace(/[^0-9]/gi,""),t=o.saved[1];o.savedNum=Math.floor(e/t),o.purchases.push({buy:o.saved[1],buyPoint:{x:o.saved[0],y:o.saved[1]},sell:null,sellPoint:null}),T()}function te(){o.selled=a[l.value],o.purchases[o.purchases.length-1].sell=o.selled[1],o.purchases[o.purchases.length-1].sellPoint={x:o.selled[0],y:o.selled[1]},o.saved=null,o.selled=null}function ae(){te(),T()}function se(e,t){const a=(r.width-35-0)/o.steps,s=(r.height-80-20)/(o.maxValue-o.minValue);return{x:0+e*a,y:r.height-40-t*s+o.minValue*s}}function le(){const{width:e,height:t}=q.value.getBoundingClientRect();r.width=Math.round(e),r.height=Math.round(t)}function ne(e){if(e.code&&"keyw"===e.code.toLowerCase())if(o.isStarted){if(o.isStarted&&!o.isPause&&B.value&&!o.saved&&!(o.startSum<O.value[1]))return void ee();if(!o.isPause&&B.value&&o.saved&&!_.value)return void ae();o.isPause&&A()}else o.startSum=o.startSum.replace(/[^0-9]/gi,""),o.startSum&&o.startSum>=o.minValue&&(A(),e.preventDefault(),e.stopPropagation())}function ue(e){e.code&&"keyw"===e.code.toLowerCase()&&(e.preventDefault(),e.stopPropagation(),o.startSum=(o.startSum||"").replace(/[^0-9]/gi,""))}return p((()=>{const{width:e,height:t}=q.value.getBoundingClientRect();l.value=0,r.width=Math.round(e),r.height=Math.round(t),window.addEventListener("resize",le),window.addEventListener("keyup",ne)})),h((()=>{window.removeEventListener("resize",le)})),(a,s)=>(u(),i(g,null,[m("div",I,[m("div",N,[m("div",z,[f(E)?x("",!0):(u(),i("span",U," ")),f(E)&&null==f(E).sell?(u(),i("span",R,b((+f(E).buy.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):x("",!0),f(E)&&null!=f(E).sell?(u(),i("span",Y,b((+f(E).sell.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):x("",!0)])]),m("div",{ref:q,class:"graph-container"},[K,(u(),i("svg",{class:"graph",width:f(r).width+10,height:f(r).height,viewBox:`${f(r).x} ${f(r).y} ${f(r).width+10} ${f(r).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${f(r).height}, ${f(r).width} ${f(r).height}`},null,8,["d"]),(u(!0),i(g,null,k(f(C),(e=>(u(),i(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${f(r).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},b(e.value<1?(+e.value.toFixed(2)).toLocaleString("ru"):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${f(r).height}, 0 0`},null,8,["d"]),(u(!0),i(g,null,k(f(j),((e,t)=>(u(),i(g,{key:t},[m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:f(r).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"])],64)))),128)),m("path",{class:["line-path",{"is-animate":B.value}],style:{opacity:f(o).isStarted?1:0,transition:f(o).isStarted?1.5*f(c)+"s":void 0},"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",d:f(M)},null,14,["d"]),(u(!0),i(g,null,k(f(j),((e,t)=>(u(),i(g,{key:t},[m("circle",{cx:e.x,cy:e.y,r:"5",class:["point-circle",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},null,10,["cx","cy"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:["point-text",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},b((+e.value.toFixed(2)).toLocaleString("ru")),11,["x","y"])],64)))),128))],8,["width","height","viewBox"]))],512)]),m("div",G,b(e.year)+" год",1),m("div",H,[m("div",J,[f(_)?(u(),i("div",Q,[m("div",W,b((+f(_).sum.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1),f(_)?(u(),i("div",{key:0,class:["current-diff",{up:f(_).value>0,down:f(_).value<0}]},[f(_).value?(u(),i("div",{key:0,class:["arrow",{up:f(_).value>0,down:f(_).value<0}]},null,2)):x("",!0),w(" "+b((+Math.abs(f(_).value).toFixed(2)).toLocaleString("ru"))+" "+b(t.currency?" "+t.currency:" ₽")+" ("+b((+Math.abs(f(_).perc).toFixed(2)).toLocaleString("ru"))+"%) ",1)],2)):x("",!0)])):x("",!0),f(o).isStarted?x("",!0):(u(),i("form",{key:1,onSubmit:S(A,["prevent"]),style:{position:"relative"}},[V(m("input",{type:"text",class:"text-input","onUpdate:modelValue":s[1]||(s[1]=e=>f(o).startSum=e),onKeydown:ue,placeholder:"Ваша сумма "+(t.currency?" "+t.currency:" ₽")},null,40,["placeholder"]),[[$,f(o).startSum]]),m("button",{disabled:!(f(o).startSum&&f(o).startSum>=f(o).minValue),type:"submit",class:"button fade-animation"}," Старт ",8,["disabled"])],40,["onSubmit"])),V(m("button",{class:"button fade-animation",style:{background:"green"},onClick:A}," Продолжить ",512),[[P,f(o).isPause]]),B.value&&f(o).isStarted?(u(),i("div",X,[V(m("button",{class:"button fade-animation",style:{background:"green"},onClick:ee,disabled:f(o).startSum<f(O)[1]}," Купить ",8,["disabled"]),[[P,B.value&&!f(o).saved]]),V(m("button",{class:"button fade-animation",style:{background:"red"},onClick:ae}," Продать ",512),[[P,B.value&&f(o).saved&&!f(_)]])])):x("",!0)])])],64))},__scopeId:"data-v-97a38fea"};const ee=O();c("data-v-2c57e6fd");const te={class:"app-container"},ae={class:"container"},se={key:0,class:"title-container"},le={class:"subtitle"},ne={class:"container"};o();const ue={expose:[],setup(e){const t=M(),a=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=d(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),l=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];a.points.push(...s.map(((e,t,s)=>{const u=null!=l[t]?l[t]:n;return n=u,[t,a.isBucks?u*a.bucksCourse:u]})))}async function c(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=e.time||40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===t.params.id)),!l.value)return Promise.reject();a.currency=l.value.currency,a.isBucks=l.value.isBucks,await n(l.value.file)}catch(e){console.log(e)}}return F((()=>{c()})),L((()=>t.params.id),(e=>{a.points=[],B((()=>{c()}))})),(e,s)=>{const n=r("router-link");return u(),i(j,{name:"fade",appear:""},{default:ee((()=>[m("div",te,[m("header",{class:"header",style:{background:f(l)?f(l).color:void 0}},[m("div",ae,[m(n,{class:"back-btn",to:f(t).query.from||"/"},null,8,["to"]),f(l)?(u(),i("div",se,[m("div",null,b(f(l).title),1),m("div",le,b(f(l).short),1)])):x("",!0)])],4),m("div",ne,[f(a).points&&f(a).points.length?(u(),i(Z,{points:f(a).points,duration:f(a).duration,id:f(t).params.id,key:f(t).params.id,currency:f(a).currency,year:f(l).year},null,8,["points","duration","id","currency","year"])):x("",!0)])])])),_:1})}},__scopeId:"data-v-2c57e6fd"};const ie=O();c("data-v-0bc6bf85");const re={class:"container"},ce=m("h1",{class:"h1"},"Выберите компанию",-1),oe={class:"items is-full"},de=m("h1",{class:"h1"},"Выберите компании",-1),ve={key:0,class:"items"};o();const ye={expose:[],setup(e){const t=M(),a=_();const s=v({items:[],isFullscreen:E.isFullscreen,selected:[],preSelected:[]}),l=y((()=>s.selected&&s.selected.length>0)),n=y((()=>s.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),c=y((()=>s.items.filter((e=>-1!==s.selected.indexOf(e.file)))));function o(){a.push({query:{selected:s.preSelected}}),s.selected=s.preSelected,s.preSelected=[]}function d(){E.isEnabled&&(s.isFullscreen=!E.isFullscreen,E.toggle())}return F((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();s.items=e.sources,s.selected=t.query.selected||[]})),L((()=>t.query.selected),(e=>{s.selected=t.query.selected||[]})),(e,a)=>{const v=r("router-link");return u(),i(j,{name:"fade",appear:""},{default:ie((()=>[m("div",re,[f(l)?(u(),i(v,{key:0,class:"back-btn",to:f(t).query.from||"/"},null,8,["to"])):x("",!0),m("button",{class:["fullscreen-icon",{off:f(s).isFullscreen}],onClick:d},null,2),f(l)&&f(s).items?(u(),i(g,{key:1},[ce,m("div",oe,[(u(!0),i(g,null,k(f(c),(e=>(u(),i("div",{class:"item",style:{background:e.color},key:e.file},[m(v,{to:{path:`/${e.file}`,query:{from:f(t).fullPath}}},{default:ie((()=>[w(b(e.title)+" "+b(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(u(),i(g,{key:2},[de,f(s).items?(u(),i("div",ve,[(u(!0),i(g,null,k(f(s).items,(e=>(u(),i("div",{class:["item",{selected:f(n)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:t=>function(e){-1===s.preSelected.indexOf(e)?s.preSelected.push(e):s.preSelected=s.preSelected.filter((t=>t!==e))}(e.file)},b(e.title)+" "+b(e.year),9,["onClick"])],6)))),128))])):x("",!0),f(l)?x("",!0):(u(),i("button",{key:1,type:"button",disabled:!f(s).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-0bc6bf85"},pe=q({routes:[{path:"",component:ye},{path:"/:id",component:ue}],history:D()}),he=T(A);he.use(pe),he.mount("#app");
