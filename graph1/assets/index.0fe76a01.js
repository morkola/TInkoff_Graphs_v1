var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{p as l,a as i,o as r,c as u,r as c,b as d,d as o,e as v,f as p,g as y,h as m,u as h,i as x,t as f,F as g,j as w,T as b,k,w as V,l as $,v as S,m as j,n as M,q as F,s as _,x as C,y as E,z as O,A,B as D,C as B,D as L}from"./vendor.92cf6a51.js";l("data-v-5389a9ea"),i();const P={expose:[],setup:e=>(e,a)=>{const t=c("router-view");return r(),u(t)}};const T=M();l("data-v-436a2d96");const I={class:"graph-wrapper"},z={class:"price"},N={class:"current-price",v:""},U={key:0},R={key:1},Y={key:2},q=F('<div class="axis-x" data-v-436a2d96><div class="x-item" data-v-436a2d96>Янв</div><div class="x-item" data-v-436a2d96>Фев</div><div class="x-item" data-v-436a2d96>Мар</div><div class="x-item" data-v-436a2d96>Апр</div><div class="x-item" data-v-436a2d96>Май</div><div class="x-item" data-v-436a2d96>Июн</div><div class="x-item" data-v-436a2d96>Июл</div><div class="x-item" data-v-436a2d96>Авг</div><div class="x-item" data-v-436a2d96>Сен</div><div class="x-item" data-v-436a2d96>Окт</div><div class="x-item" data-v-436a2d96>Ноя</div><div class="x-item" data-v-436a2d96>Дек</div></div>',1),G={class:"footer"},H={class:"container"},J={key:0,class:"price"},K={class:"current-price"},Q={key:0,style:{position:"relative"}};i();const W={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const l=e,{points:i,duration:c}=l;d(400),d(400),d(0),d(0);const M=d(0),F=o({width:1e3,height:400,x:-30,y:0}),_=v((()=>c/i.length));let C=o({startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,values:v((()=>[...i].map((e=>e[1])))),maxValue:v((()=>[...i].reduce(((e,a)=>null===e||+a[1]>e?+a[1]:e),null))),minValue:v((()=>[...i].reduce(((e,a)=>null===e||e>a[1]?a[1]:e),null))),steps:v((()=>[...i].length))}),E=v((()=>[{x:0,value:C.minValue,y:C.minValue&&C.maxValue?se(0,C.minValue).y:0},{x:0,value:C.maxValue,y:C.minValue&&C.maxValue?se(0,C.maxValue).y:0},{x:0,value:C.minValue&&C.maxValue?C.minValue+(C.maxValue-C.minValue)/2:0,y:C.minValue&&C.maxValue?se(0,C.minValue+(C.maxValue-C.minValue)/2).y:0}]));const O=v((()=>i.reduce(((e,a)=>(e.push(se(a[0],a[1])),e)),[]))),A=v((()=>O.value.reduce(((e,a,t,s)=>{if(t){const n=s[t-1],l=a;e.push(`M${n.x} ${n.y}, ${l.x} ${l.y}`)}return e}),[]))),D=v((()=>O.value.reduce(((e,a,t,s)=>{if(t&&t<=M.value){const n=s[t-1],l=a;e+=`${n.x} ${n.y}, ${l.x} ${l.y} `}return e}),"")));v((()=>[...A.value].filter(((e,a)=>a<M.value))));const B=v((()=>[...i].filter(((e,a)=>e===C.saved||e===C.selled)).map((e=>((e,l)=>{for(var i in l||(l={}))t.call(l,i)&&n(e,i,l[i]);if(a)for(var i of a(l))s.call(l,i)&&n(e,i,l[i]);return e})({value:e[1]},se(e[0],e[1]))))));v((()=>i[M.value])),v((()=>+(M.value>0?i[M.value][1]-i[M.value-1][1]:0).toFixed(2)));const L=d(!1),P=v((()=>{if(C.saved&&C.selled){const e=+C.startSum.replace(/[^0-9]/gi,""),a=C.saved[1],t=C.selled[1],s=Math.floor(e/a),n=e-s*a,l=a*s,i=t*s;return{sum:i+n,value:i-l,perc:i?100*(i-l+n)/i:0}}return null}));function W(e){e+1<C.steps?M.value=e+1:(L.value=!1,console.timeEnd("time"),null==C.selled&&(C.selled=i[C.steps-1]))}const X=d(null);function Z(){console.time("time"),C.isStarted=!0,L.value=!0,ee()}function ee(){W(M.value),L.value&&setTimeout((()=>{ee()}),1e3*_.value)}function ae(){C.saved=i[M.value];const e=+C.startSum.replace(/[^0-9]/gi,""),a=C.saved[1];C.savedNum=Math.floor(e/a)}function te(){C.selled=i[M.value]}function se(e,a){const t=(F.width-35-0)/C.steps,s=(F.height-80-20)/(C.maxValue-C.minValue);return{x:0+e*t,y:F.height-40-a*s+C.minValue*s}}function ne(){const{width:e,height:a}=X.value.getBoundingClientRect();F.width=Math.round(e),F.height=Math.round(a)}return p((()=>{const{width:e,height:a}=X.value.getBoundingClientRect();M.value=0,F.width=Math.round(e),F.height=Math.round(a),window.addEventListener("resize",ne)})),y((()=>{window.removeEventListener("resize",ne)})),(e,a)=>(r(),u(g,null,[m("div",I,[m("div",z,[m("div",N,[h(C).saved?x("",!0):(r(),u("span",U," ")),h(C).saved&&!h(C).selled?(r(),u("span",R,f(+h(C).saved[1].toFixed(2)+(l.currency?" "+l.currency:" ₽")),1)):x("",!0),h(C).selled?(r(),u("span",Y,f(+h(C).selled[1].toFixed(2)+(l.currency?" "+l.currency:" ₽")),1)):x("",!0)])]),m("div",{ref:X,class:"graph-container"},[q,(r(),u("svg",{class:"graph",width:h(F).width+10,height:h(F).height,viewBox:`${h(F).x} ${h(F).y} ${h(F).width+10} ${h(F).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${h(F).height}, ${h(F).width} ${h(F).height}`},null,8,["d"]),(r(!0),u(g,null,w(h(E),(e=>(r(),u(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${h(F).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},f(Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${h(F).height}, 0 0`},null,8,["d"]),(r(!0),u(g,null,w(h(B),((e,a)=>(r(),u(g,{key:a},[m("circle",{cx:e.x,cy:e.y,r:"5",fill:"red",class:"point-circle"},null,8,["cx","cy"]),m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:h(F).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:"point-text"},f(e.value),9,["x","y"])],64)))),128)),m("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:h(D)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),m("div",G,[m("div",H,[h(P)?(r(),u("div",J,[m("div",K,f(+h(P).sum.toFixed(2).toLocaleString()+(l.currency?" "+l.currency:" ₽")),1),m(b,{name:"fade",appear:""},{default:T((()=>[h(P)?(r(),u("div",{key:0,class:["current-diff",{up:h(P).value>0,down:h(P).value<0}]},[h(P).value?(r(),u("div",{key:0,class:["arrow",{up:h(P).value>0,down:h(P).value<0}]},null,2)):x("",!0),k(" "+f(+Math.abs(h(P).value).toFixed(2))+" "+f(l.currency?" "+l.currency:" ₽")+" ("+f(+Math.abs(h(P).perc).toFixed(2))+"%) ",1)],2)):x("",!0)])),_:1})])):x("",!0),h(C).isStarted?x("",!0):(r(),u("form",{key:1,onSubmit:V(Z,["prevent"]),style:{position:"relative"}},[$(m("input",{type:"text",class:"text-input","onUpdate:modelValue":a[1]||(a[1]=e=>h(C).startSum=e),placeholder:"Ваша сумма "+(l.currency?" "+l.currency:" ₽")},null,8,["placeholder"]),[[S,h(C).startSum]]),m("button",{disabled:!h(C).startSum,type:"submit",class:"button"}," Старт ",8,["disabled"])],40,["onSubmit"])),m(b,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[L.value&&h(C).isStarted?(r(),u("div",Q,[m(b,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[$(m("button",{class:"button",style:{background:"green"},onClick:ae}," Купить ",512),[[j,L.value&&!h(C).saved]])])),_:1}),$(m("button",{class:"button",style:{background:"#e91e63"},onClick:te}," Продать ",512),[[j,L.value&&h(C).saved&&!h(P)]])])):x("",!0)])),_:1})])])],64))},__scopeId:"data-v-436a2d96"};const X=M();l("data-v-12b6db32");const Z={class:"app-container"},ee={class:"container"},ae={key:0,class:"title-container"},te={class:"subtitle"},se={class:"container"};i();const ne={expose:[],setup(e){const a=E(),t=o({points:[],duration:40,currency:"$"});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let n=d(null);async function l(e){const a=await fetch(`data/${e}.json`).then((e=>e.json())),n=a.reduce(((e,a)=>{var t;return e[(t=new Date(a["<DATE>"]),(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-Date.UTC(t.getFullYear(),0,0))/24/60/60/1e3)-1]=a["<CLOSE>"],e}),{});let l=a[0]["<CLOSE>"];t.points.push(...s.map(((e,a,t)=>{const s=null!=n[a]?n[a]:l;return l=s,[a,s]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(t.duration=e.time||40,!Array.isArray(e.sources))return Promise.reject();if(n.value=e.sources.find((e=>e.file===a.params.id)),!n.value)return Promise.reject();t.currency=n.value.currency,await l(n.value.file)}catch(e){}}return _((()=>{i()})),C((()=>a.params.id),(e=>{t.points=[],O((()=>{i()}))})),(e,s)=>{const l=c("router-link");return r(),u(b,{name:"fade",appear:""},{default:X((()=>[m("div",Z,[m("header",{class:"header",style:{background:h(n)?h(n).color:void 0}},[m("div",ee,[m(l,{class:"back-btn",to:"/"}),h(n)?(r(),u("div",ae,[m("div",null,f(h(n).title),1),m("div",te,f(h(n).short)+" "+f(h(n).year),1)])):x("",!0)])],4),m("div",se,[h(t).points&&h(t).points.length?(r(),u(W,{points:h(t).points,duration:h(t).duration,id:h(a).params.id,key:h(a).params.id,currency:h(t).currency},null,8,["points","duration","id","currency"])):x("",!0)])])])),_:1})}},__scopeId:"data-v-12b6db32"};const le=M();l("data-v-66d8e0a8");const ie={class:"container"},re=m("h1",{class:"h1"},"Выберите компанию",-1),ue={key:0,class:"items"};i();const ce={expose:[],setup(e){const a=o({items:[],isFullscreen:A.isFullscreen});function t(){A.isEnabled&&(a.isFullscreen=!A.isFullscreen,A.toggle())}return _((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();a.items=e.sources})),(e,s)=>{const n=c("router-link");return r(),u(b,{name:"fade",appear:""},{default:le((()=>[m("div",ie,[m("button",{class:["fullscreen-icon",{off:h(a).isFullscreen}],onClick:t},null,2),re,h(a).items?(r(),u("div",ue,[(r(!0),u(g,null,w(h(a).items,(e=>(r(),u("div",{class:"item",style:{background:e.color},key:e.file},[m(n,{to:`/${e.file}`},{default:le((()=>[k(f(e.title)+" "+f(e.year),1)])),_:2},1032,["to"])],4)))),128))])):x("",!0)])])),_:1})}},__scopeId:"data-v-66d8e0a8"},de=D({routes:[{path:"",component:ce},{path:"/:id",component:ne}],history:B()}),oe=L(P);oe.use(de),oe.mount("#app");
