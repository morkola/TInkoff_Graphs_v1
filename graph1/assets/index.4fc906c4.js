var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{p as n,a as i,o as r,c as u,r as c,b as o,d,e as v,f as p,g as y,h,u as m,t as f,i as x,F as b,j as g,T as w,k,w as V,l as $,v as S,m as j,n as M,q as F,s as _,x as C,y as O,z as E,A,B as D,C as L,D as B}from"./vendor.92cf6a51.js";n("data-v-d415dcd8"),i();const P={expose:[],setup:e=>(e,t)=>{const a=c("router-view");return r(),u(a)}};const T=M();n("data-v-690eb4fe");const I={class:"graph-wrapper"},z={class:"price"},N={key:0,class:"current-price"},U=F('<div class="axis-x" data-v-690eb4fe><div class="x-item" data-v-690eb4fe>Янв</div><div class="x-item" data-v-690eb4fe>Фев</div><div class="x-item" data-v-690eb4fe>Мар</div><div class="x-item" data-v-690eb4fe>Апр</div><div class="x-item" data-v-690eb4fe>Май</div><div class="x-item" data-v-690eb4fe>Июн</div><div class="x-item" data-v-690eb4fe>Июл</div><div class="x-item" data-v-690eb4fe>Авг</div><div class="x-item" data-v-690eb4fe>Сен</div><div class="x-item" data-v-690eb4fe>Окт</div><div class="x-item" data-v-690eb4fe>Ноя</div><div class="x-item" data-v-690eb4fe>Дек</div></div>',1),R={class:"footer"},Y={class:"container"},q={key:0,class:"price"},G={class:"current-price"},H={key:0,style:{position:"relative"}};i();const J={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const n=e,{points:i,duration:c}=n;o(400),o(400),o(0),o(0);const M=o(0),F=d({width:1e3,height:400,x:-30,y:0}),_=v((()=>c/i.length));let C=d({startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,values:v((()=>[...i].map((e=>e[1])))),maxValue:v((()=>[...i].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:v((()=>[...i].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:v((()=>[...i].length))}),O=v((()=>[{x:0,value:C.minValue,y:C.minValue&&C.maxValue?te(0,C.minValue).y:0},{x:0,value:C.maxValue,y:C.minValue&&C.maxValue?te(0,C.maxValue).y:0},{x:0,value:C.minValue&&C.maxValue?C.minValue+(C.maxValue-C.minValue)/2:0,y:C.minValue&&C.maxValue?te(0,C.minValue+(C.maxValue-C.minValue)/2).y:0}]));const E=v((()=>i.reduce(((e,t)=>(e.push(te(t[0],t[1])),e)),[]))),A=v((()=>E.value.reduce(((e,t,a,s)=>{if(a){const l=s[a-1],n=t;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),D=v((()=>E.value.reduce(((e,t,a,s)=>{if(a&&a<=M.value){const l=s[a-1],n=t;e+=`${l.x} ${l.y}, ${n.x} ${n.y} `}return e}),"")));v((()=>[...A.value].filter(((e,t)=>t<M.value))));const L=v((()=>[...i].filter(((e,t)=>e===C.saved||e===C.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))a.call(n,i)&&l(e,i,n[i]);if(t)for(var i of t(n))s.call(n,i)&&l(e,i,n[i]);return e})({value:e[1]},te(e[0],e[1])))))),B=v((()=>i[M.value]));v((()=>+(M.value>0?i[M.value][1]-i[M.value-1][1]:0).toFixed(2)));const P=o(!1),J=v((()=>{if(C.saved&&C.selled){const e=+C.startSum.replace(/[^0-9]/gi,""),t=C.saved[1],a=C.selled[1],s=Math.floor(e/t),l=e-s*t,n=t*s,i=a*s;return{sum:i+l,value:i-n,perc:i?100*(i-n+l)/i:0}}return null}));function K(e){e+1<C.steps?M.value=e+1:(P.value=!1,null==C.selled&&(C.selled=i[C.steps-1]))}const Q=o(null);function W(){C.isStarted=!0,P.value=!0,X()}function X(){K(M.value),P.value&&setTimeout((()=>{X()}),1e3*_.value)}function Z(){C.saved=i[M.value];const e=+C.startSum.replace(/[^0-9]/gi,""),t=C.saved[1];C.savedNum=Math.floor(e/t)}function ee(){C.selled=i[M.value]}function te(e,t){const a=(F.width-35-0)/C.steps,s=(F.height-80-20)/(C.maxValue-C.minValue);return{x:0+e*a,y:F.height-40-t*s+C.minValue*s}}function ae(){const{width:e,height:t}=Q.value.getBoundingClientRect();F.width=Math.round(e),F.height=Math.round(t)}return p((()=>{const{width:e,height:t}=Q.value.getBoundingClientRect();M.value=0,F.width=Math.round(e),F.height=Math.round(t),window.addEventListener("resize",ae)})),y((()=>{window.removeEventListener("resize",ae)})),(e,t)=>(r(),u(b,null,[h("div",I,[h("div",z,[m(B)||m(C).selled?(r(),u("div",N,f(m(C).selled?+m(C).selled[1].toFixed(2)+(n.currency?" "+n.currency:" ₽"):m(B)[1].toLocaleString()+(n.currency?" "+n.currency:" ₽")),1)):x("",!0)]),h("div",{ref:Q,class:"graph-container"},[U,(r(),u("svg",{class:"graph",width:m(F).width+10,height:m(F).height,viewBox:`${m(F).x} ${m(F).y} ${m(F).width+10} ${m(F).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{class:"axis",d:`M0 ${m(F).height}, ${m(F).width} ${m(F).height}`},null,8,["d"]),(r(!0),u(b,null,g(m(O),(e=>(r(),u(b,{key:e.value},[h("path",{class:"y-line",d:`M0 ${e.y}, ${m(F).width} ${e.y}`},null,8,["d"]),h("text",{x:"-25",y:e.y+4,class:"y-text"},f(Math.round(e.value)),9,["y"])],64)))),128)),h("path",{class:"axis",d:`M0 ${m(F).height}, 0 0`},null,8,["d"]),(r(!0),u(b,null,g(m(L),((e,t)=>(r(),u(b,{key:t},[h("circle",{cx:e.x,cy:e.y,r:"5",fill:"red",class:"point-circle"},null,8,["cx","cy"]),h("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:m(F).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),h("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),h("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:"point-text"},f(e.value),9,["x","y"])],64)))),128)),h("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:m(D)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),h("div",R,[h("div",Y,[m(J)?(r(),u("div",q,[h("div",G,f(+m(J).sum.toFixed(2).toLocaleString()+(n.currency?" "+n.currency:" ₽")),1),h(w,{name:"fade",appear:""},{default:T((()=>[m(J)?(r(),u("div",{key:0,class:["current-diff",{up:m(J).value>0,down:m(J).value<0}]},[m(J).value?(r(),u("div",{key:0,class:["arrow",{up:m(J).value>0,down:m(J).value<0}]},null,2)):x("",!0),k(" "+f(+Math.abs(m(J).value).toFixed(2))+" "+f(n.currency?" "+n.currency:" ₽")+" ("+f(+Math.abs(m(J).perc).toFixed(2))+"%) ",1)],2)):x("",!0)])),_:1})])):x("",!0),m(C).isStarted?x("",!0):(r(),u("form",{key:1,onSubmit:V(W,["prevent"]),style:{position:"relative"}},[$(h("input",{type:"text",class:"text-input","onUpdate:modelValue":t[1]||(t[1]=e=>m(C).startSum=e),placeholder:"Ваша сумма "+(n.currency?" "+n.currency:" ₽")},null,8,["placeholder"]),[[S,m(C).startSum]]),h("button",{disabled:!m(C).startSum,type:"submit",class:"button"}," Старт ",8,["disabled"])],40,["onSubmit"])),h(w,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[P.value&&m(C).isStarted?(r(),u("div",H,[h(w,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[$(h("button",{class:"button",style:{background:"green"},onClick:Z}," Купить ",512),[[j,P.value&&!m(C).saved]])])),_:1}),$(h("button",{class:"button",style:{background:"#e91e63"},onClick:ee}," Продать ",512),[[j,P.value&&m(C).saved&&!m(J)]])])):x("",!0)])),_:1})])])],64))},__scopeId:"data-v-690eb4fe"};const K=M();n("data-v-12b6db32");const Q={class:"app-container"},W={class:"container"},X={key:0,class:"title-container"},Z={class:"subtitle"},ee={class:"container"};i();const te={expose:[],setup(e){const t=O(),a=d({points:[],duration:40,currency:"$"});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=o(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),l=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];a.points.push(...s.map(((e,t,a)=>{const s=null!=l[t]?l[t]:n;return n=s,[t,s]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=e.time||40,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===t.params.id)),!l.value)return Promise.reject();a.currency=l.value.currency,await n(l.value.file)}catch(e){}}return _((()=>{i()})),C((()=>t.params.id),(e=>{a.points=[],E((()=>{i()}))})),(e,s)=>{const n=c("router-link");return r(),u(w,{name:"fade",appear:""},{default:K((()=>[h("div",Q,[h("header",{class:"header",style:{background:m(l)?m(l).color:void 0}},[h("div",W,[h(n,{class:"back-btn",to:"/"}),m(l)?(r(),u("div",X,[h("div",null,f(m(l).title),1),h("div",Z,f(m(l).short)+" "+f(m(l).year),1)])):x("",!0)])],4),h("div",ee,[m(a).points&&m(a).points.length?(r(),u(J,{points:m(a).points,duration:m(a).duration,id:m(t).params.id,key:m(t).params.id,currency:m(a).currency},null,8,["points","duration","id","currency"])):x("",!0)])])])),_:1})}},__scopeId:"data-v-12b6db32"};const ae=M();n("data-v-66d8e0a8");const se={class:"container"},le=h("h1",{class:"h1"},"Выберите компанию",-1),ne={key:0,class:"items"};i();const ie={expose:[],setup(e){const t=d({items:[],isFullscreen:A.isFullscreen});function a(){A.isEnabled&&(t.isFullscreen=!A.isFullscreen,A.toggle())}return _((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();t.items=e.sources})),(e,s)=>{const l=c("router-link");return r(),u(w,{name:"fade",appear:""},{default:ae((()=>[h("div",se,[h("button",{class:["fullscreen-icon",{off:m(t).isFullscreen}],onClick:a},null,2),le,m(t).items?(r(),u("div",ne,[(r(!0),u(b,null,g(m(t).items,(e=>(r(),u("div",{class:"item",style:{background:e.color},key:e.file},[h(l,{to:`/${e.file}`},{default:ae((()=>[k(f(e.title)+" "+f(e.year),1)])),_:2},1032,["to"])],4)))),128))])):x("",!0)])])),_:1})}},__scopeId:"data-v-66d8e0a8"},re=D({routes:[{path:"",component:ie},{path:"/:id",component:te}],history:L()}),ue=B(P);ue.use(re),ue.mount("#app");
