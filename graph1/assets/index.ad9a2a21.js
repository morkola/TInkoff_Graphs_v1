var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{p as n,a as i,o as c,c as u,r,b as o,d,e as v,f as p,g as y,h as m,u as h,i as f,t as x,F as g,j as k,T as w,k as b,w as V,l as $,v as S,m as j,n as F,q as M,s as C,x as _,y as B,z as E,A as O,B as A,C as D,D as L}from"./vendor.92cf6a51.js";n("data-v-5389a9ea"),i();const P={expose:[],setup:e=>(e,a)=>{const t=r("router-view");return c(),u(t)}};const T=F();n("data-v-251c3fc2");const I={class:"graph-wrapper"},z={class:"price"},N={class:"current-price",v:""},U={key:0},R={key:1},Y={key:2},q=M('<div class="axis-x" data-v-251c3fc2><div class="x-item" data-v-251c3fc2>Янв</div><div class="x-item" data-v-251c3fc2>Фев</div><div class="x-item" data-v-251c3fc2>Мар</div><div class="x-item" data-v-251c3fc2>Апр</div><div class="x-item" data-v-251c3fc2>Май</div><div class="x-item" data-v-251c3fc2>Июн</div><div class="x-item" data-v-251c3fc2>Июл</div><div class="x-item" data-v-251c3fc2>Авг</div><div class="x-item" data-v-251c3fc2>Сен</div><div class="x-item" data-v-251c3fc2>Окт</div><div class="x-item" data-v-251c3fc2>Ноя</div><div class="x-item" data-v-251c3fc2>Дек</div></div>',1),G={class:"footer"},H={class:"container"},J={key:0,class:"price"},K={class:"current-price"},Q={key:0,style:{position:"relative"}};i();const W={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const n=e,{points:i,duration:r}=n;o(400),o(400),o(0),o(0);const F=o(0),M=d({width:1e3,height:400,x:-30,y:0}),C=v((()=>r/i.length));let _=d({startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,values:v((()=>[...i].map((e=>e[1])))),maxValue:v((()=>[...i].reduce(((e,a)=>null===e||+a[1]>e?+a[1]:e),null))),minValue:v((()=>[...i].reduce(((e,a)=>null===e||e>a[1]?a[1]:e),null))),steps:v((()=>[...i].length))}),B=v((()=>[{x:0,value:_.minValue,y:_.minValue&&_.maxValue?se(0,_.minValue).y:0},{x:0,value:_.maxValue,y:_.minValue&&_.maxValue?se(0,_.maxValue).y:0},{x:0,value:_.minValue&&_.maxValue?_.minValue+(_.maxValue-_.minValue)/2:0,y:_.minValue&&_.maxValue?se(0,_.minValue+(_.maxValue-_.minValue)/2).y:0}]));const E=v((()=>i.reduce(((e,a)=>(e.push(se(a[0],a[1])),e)),[]))),O=v((()=>E.value.reduce(((e,a,t,s)=>{if(t){const l=s[t-1],n=a;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),A=v((()=>E.value.reduce(((e,a,t,s)=>{if(t&&t<=F.value){const l=s[t-1],n=a;e+=`${l.x} ${l.y}, ${n.x} ${n.y} `}return e}),"")));v((()=>[...O.value].filter(((e,a)=>a<F.value))));const D=v((()=>[...i].filter(((e,a)=>e===_.saved||e===_.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))t.call(n,i)&&l(e,i,n[i]);if(a)for(var i of a(n))s.call(n,i)&&l(e,i,n[i]);return e})({value:e[1]},se(e[0],e[1]))))));v((()=>i[F.value])),v((()=>+(F.value>0?i[F.value][1]-i[F.value-1][1]:0).toFixed(2)));const L=o(!1),P=v((()=>{if(_.saved&&_.selled){const e=+_.startSum.replace(/[^0-9]/gi,""),a=_.saved[1],t=_.selled[1],s=Math.floor(e/a),l=e-s*a,n=a*s,i=t*s;return{sum:i+l,value:i-n,perc:i?100*(i-n+l)/i:0}}return null}));function W(e){e+1<_.steps?F.value=e+1:(L.value=!1,console.timeEnd("time"),null==_.selled&&(_.selled=i[_.steps-1]))}const X=o(null);function Z(){console.time("time"),_.isStarted=!0,L.value=!0,ee()}function ee(){W(F.value),L.value&&setTimeout((()=>{ee()}),1e3*C.value)}function ae(){_.saved=i[F.value];const e=+_.startSum.replace(/[^0-9]/gi,""),a=_.saved[1];_.savedNum=Math.floor(e/a)}function te(){_.selled=i[F.value]}function se(e,a){const t=(M.width-35-0)/_.steps,s=(M.height-80-20)/(_.maxValue-_.minValue);return{x:0+e*t,y:M.height-40-a*s+_.minValue*s}}function le(){const{width:e,height:a}=X.value.getBoundingClientRect();M.width=Math.round(e),M.height=Math.round(a)}return p((()=>{const{width:e,height:a}=X.value.getBoundingClientRect();F.value=0,M.width=Math.round(e),M.height=Math.round(a),window.addEventListener("resize",le)})),y((()=>{window.removeEventListener("resize",le)})),(e,a)=>(c(),u(g,null,[m("div",I,[m("div",z,[m("div",N,[h(_).saved?f("",!0):(c(),u("span",U," ")),h(_).saved&&!h(_).selled?(c(),u("span",R,x(+h(_).saved[1].toFixed(2)+(n.currency?" "+n.currency:" ₽")),1)):f("",!0),h(_).selled?(c(),u("span",Y,x(+h(_).selled[1].toFixed(2)+(n.currency?" "+n.currency:" ₽")),1)):f("",!0)])]),m("div",{ref:X,class:"graph-container"},[q,(c(),u("svg",{class:"graph",width:h(M).width+10,height:h(M).height,viewBox:`${h(M).x} ${h(M).y} ${h(M).width+10} ${h(M).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${h(M).height}, ${h(M).width} ${h(M).height}`},null,8,["d"]),(c(!0),u(g,null,k(h(B),(e=>(c(),u(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${h(M).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},x(e.value<1?+e.value.toFixed(2):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${h(M).height}, 0 0`},null,8,["d"]),(c(!0),u(g,null,k(h(D),((e,a)=>(c(),u(g,{key:a},[m("circle",{cx:e.x,cy:e.y,r:"5",fill:"red",class:"point-circle"},null,8,["cx","cy"]),m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:h(M).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:"point-text"},x(e.value),9,["x","y"])],64)))),128)),m("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:h(A)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),m("div",G,[m("div",H,[h(P)?(c(),u("div",J,[m("div",K,x(+h(P).sum.toFixed(2).toLocaleString()+(n.currency?" "+n.currency:" ₽")),1),m(w,{name:"fade",appear:""},{default:T((()=>[h(P)?(c(),u("div",{key:0,class:["current-diff",{up:h(P).value>0,down:h(P).value<0}]},[h(P).value?(c(),u("div",{key:0,class:["arrow",{up:h(P).value>0,down:h(P).value<0}]},null,2)):f("",!0),b(" "+x(+Math.abs(h(P).value).toFixed(2))+" "+x(n.currency?" "+n.currency:" ₽")+" ("+x(+Math.abs(h(P).perc).toFixed(2))+"%) ",1)],2)):f("",!0)])),_:1})])):f("",!0),h(_).isStarted?f("",!0):(c(),u("form",{key:1,onSubmit:V(Z,["prevent"]),style:{position:"relative"}},[$(m("input",{type:"text",class:"text-input","onUpdate:modelValue":a[1]||(a[1]=e=>h(_).startSum=e),placeholder:"Ваша сумма "+(n.currency?" "+n.currency:" ₽")},null,8,["placeholder"]),[[S,h(_).startSum]]),m("button",{disabled:!h(_).startSum,type:"submit",class:"button"}," Старт ",8,["disabled"])],40,["onSubmit"])),m(w,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[L.value&&h(_).isStarted?(c(),u("div",Q,[m(w,{name:"fade",mode:"in-out",appear:""},{default:T((()=>[$(m("button",{class:"button",style:{background:"green"},onClick:ae}," Купить ",512),[[j,L.value&&!h(_).saved]])])),_:1}),$(m("button",{class:"button",style:{background:"#e91e63"},onClick:te}," Продать ",512),[[j,L.value&&h(_).saved&&!h(P)]])])):f("",!0)])),_:1})])])],64))},__scopeId:"data-v-251c3fc2"};const X=F();n("data-v-06f7fd98");const Z={class:"app-container"},ee={class:"container"},ae={key:0,class:"title-container"},te={class:"subtitle"},se={class:"container"};i();const le={expose:[],setup(e){const a=B(),t=d({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=o(null);async function n(e){const a=await fetch(`data/${e}.json`).then((e=>e.json())),l=a.reduce(((e,a)=>{var t;return e[(t=new Date(a["<DATE>"]),(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-Date.UTC(t.getFullYear(),0,0))/24/60/60/1e3)-1]=a["<CLOSE>"],e}),{});let n=a[0]["<CLOSE>"];t.points.push(...s.map(((e,a,s)=>{const i=null!=l[a]?l[a]:n;return n=i,[a,t.isBucks?i*t.bucksCourse:i]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(t.duration=e.time||40,t.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===a.params.id)),!l.value)return Promise.reject();t.currency=l.value.currency,t.isBucks=l.value.isBucks,await n(l.value.file)}catch(e){console.log(e)}}return C((()=>{i()})),_((()=>a.params.id),(e=>{t.points=[],E((()=>{i()}))})),(e,s)=>{const n=r("router-link");return c(),u(w,{name:"fade",appear:""},{default:X((()=>[m("div",Z,[m("header",{class:"header",style:{background:h(l)?h(l).color:void 0}},[m("div",ee,[m(n,{class:"back-btn",to:"/"}),h(l)?(c(),u("div",ae,[m("div",null,x(h(l).title),1),m("div",te,x(h(l).short)+" "+x(h(l).year),1)])):f("",!0)])],4),m("div",se,[h(t).points&&h(t).points.length?(c(),u(W,{points:h(t).points,duration:h(t).duration,id:h(a).params.id,key:h(a).params.id,currency:h(t).currency},null,8,["points","duration","id","currency"])):f("",!0)])])])),_:1})}},__scopeId:"data-v-06f7fd98"};const ne=F();n("data-v-66d8e0a8");const ie={class:"container"},ce=m("h1",{class:"h1"},"Выберите компанию",-1),ue={key:0,class:"items"};i();const re={expose:[],setup(e){const a=d({items:[],isFullscreen:O.isFullscreen});function t(){O.isEnabled&&(a.isFullscreen=!O.isFullscreen,O.toggle())}return C((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();a.items=e.sources})),(e,s)=>{const l=r("router-link");return c(),u(w,{name:"fade",appear:""},{default:ne((()=>[m("div",ie,[m("button",{class:["fullscreen-icon",{off:h(a).isFullscreen}],onClick:t},null,2),ce,h(a).items?(c(),u("div",ue,[(c(!0),u(g,null,k(h(a).items,(e=>(c(),u("div",{class:"item",style:{background:e.color},key:e.file},[m(l,{to:`/${e.file}`},{default:ne((()=>[b(x(e.title)+" "+x(e.year),1)])),_:2},1032,["to"])],4)))),128))])):f("",!0)])])),_:1})}},__scopeId:"data-v-66d8e0a8"},oe=A({routes:[{path:"",component:re},{path:"/:id",component:le}],history:D()}),de=L(P);de.use(oe),de.mount("#app");
