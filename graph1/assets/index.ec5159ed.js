var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,n=(e,n)=>{for(var u in n||(n={}))a.call(n,u)&&l(e,u,n[u]);if(t)for(var u of t(n))s.call(n,u)&&l(e,u,n[u]);return e};import{o as u,c as i,r,p as c,a as o,b as d,d as y,e as v,f as p,g as h,h as m,u as x,i as f,t as b,F as g,j as k,k as w,w as S,l as P,v as M,m as V,n as B,q as $,s as C,x as j,T as F,y as L,z as O,A as E,B as N,C as _,D as q,E as D}from"./vendor.4efa5d83.js";const T={};T.render=function(e,t){const a=r("router-view");return u(),i(a)};c("data-v-d7c4ac32");const A={class:"graph-wrapper"},I={class:"price"},z={class:"current-price"},U={key:0},R={key:1},Y={key:2},K=B('<div class="axis-x" data-v-d7c4ac32><div class="x-item" data-v-d7c4ac32>Янв</div><div class="x-item" data-v-d7c4ac32>Фев</div><div class="x-item" data-v-d7c4ac32>Мар</div><div class="x-item" data-v-d7c4ac32>Апр</div><div class="x-item" data-v-d7c4ac32>Май</div><div class="x-item" data-v-d7c4ac32>Июн</div><div class="x-item" data-v-d7c4ac32>Июл</div><div class="x-item" data-v-d7c4ac32>Авг</div><div class="x-item" data-v-d7c4ac32>Сен</div><div class="x-item" data-v-d7c4ac32>Окт</div><div class="x-item" data-v-d7c4ac32>Ноя</div><div class="x-item" data-v-d7c4ac32>Дек</div></div>',1),G={class:"graph-year"},H={class:"footer"},J={class:"container"},Q={key:0,class:"price"},W={class:"current-price"},X={key:2,style:{position:"relative"}};o();const Z={expose:[],props:{points:Array,duration:Number,id:String,currency:String,year:Number,emptyPoints:Object},setup(e){const t=e,{points:a,duration:s,emptyPoints:l}=t;d(400),d(400),d(0),d(0);const r=d(0),c=y({width:1e3,height:400,x:-30,y:0}),o=v((()=>s/a.length));let B=y({currentMoney:0,lastBuy:{value:0,delta:0,stocks:0,deltaPerc:0},purchases:[],startSum:null,savedNum:null,isStarted:!1,isMount:!1,saved:null,selled:null,isPause:!1,timeout:null,values:v((()=>[...a].map((e=>e[1])))),maxValue:v((()=>[...a].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:v((()=>[...a].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:v((()=>[...a].length))}),$=v((()=>[{x:0,value:B.minValue,y:B.minValue&&B.maxValue?le(0,B.minValue).y:0},{x:0,value:B.maxValue,y:B.minValue&&B.maxValue?le(0,B.maxValue).y:0},{x:0,value:B.minValue&&B.maxValue?B.minValue+(B.maxValue-B.minValue)/2:0,y:B.minValue&&B.maxValue?le(0,B.minValue+(B.maxValue-B.minValue)/2).y:0}]));const C=v((()=>a.reduce(((e,t)=>(e.push(le(t[0],t[1])),e)),[]))),j=v((()=>C.value.reduce(((e,t,a,s)=>{if(a){const l=s[a-1],n=t;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),F=v((()=>{const e=l?C.value[l.i]:C.value[0],t=C.value[r.value];return C.value.reduce(((a,s,n,u)=>(0===n?a+=`M${e.x},${e.y}`:l&&n<l.i-1||(n<=r.value?a+=` L${s.x},${s.y}`:a+=` L${t.x},${t.y}`),a)),"")}));v((()=>[...j.value].filter(((e,t)=>t<r.value))));const L=v((()=>B.purchases.reduce(((e,t)=>(t.buy&&e.push(n({type:"buy",value:t.buy},le(t.buyPoint.x,t.buyPoint.y))),t.sell&&e.push(n({type:"sell",value:t.sell},le(t.sellPoint.x,t.sellPoint.y))),e)),[]))),O=v((()=>a[r.value]));v((()=>+(r.value>0?a[r.value][1]-a[r.value-1][1]:0).toFixed(2)));const E=d(!1),N=v((()=>B.purchases&&B.purchases.length?B.purchases[B.purchases.length-1]:null)),_=v((()=>{if(N.value&&N.value.sell){const e=+B.startSum.replace(/[^0-9]/gi,""),t=N.value.buy,a=N.value.sell,s=Math.floor(e/t),l=e-s*t,n=t*s,u=a*s;return{sum:u+l,value:u-n,perc:u?100*(u-n+l)/u:0}}return null}));const q=d(null);function D(){clearTimeout(B.timeout),E.value=!1}function T(){D(),B.isPause=!0}function Z(){clearTimeout(B.timeout),B.isStarted||(B.currentMoney=+B.startSum.replace(/[^0-9]/gi,"")),B.isStarted=!0,E.value=!0,B.isPause=!1,ee()}function ee(){var e;(e=r.value)+1<B.steps?r.value=e+1:(null==B.selled&&null!=B.saved&&ae(),D()),E.value&&(B.timeout=setTimeout((()=>{ee()}),1e3*o.value))}function te(){B.saved=a[r.value];const e=B.saved[1];B.savedNum=Math.floor(B.currentMoney/e),B.purchases.push({buy:B.saved[1],buyPoint:{x:B.saved[0],y:B.saved[1]},sell:null,sellPoint:null}),B.currentMoney-=B.savedNum*e,T()}function ae(){const e=a[r.value];B.selled=e;const t=B.savedNum*e[1],s=B.purchases[B.purchases.length-1].buy*B.savedNum;B.currentMoney+=t,B.purchases[B.purchases.length-1].sell=e[1],B.purchases[B.purchases.length-1].sellPoint={x:e[0],y:e[1]},B.lastBuy.value=e[1],B.lastBuy.stocks=B.savedNum,B.lastBuy.delta=t-s,B.lastBuy.deltaPerc=+(100*B.lastBuy.delta/s).toFixed(2),B.savedNum=0,B.saved=null,B.selled=null}function se(){ae(),T()}function le(e,t){const a=(c.width-35-0)/B.steps,s=(c.height-80-20)/(B.maxValue-B.minValue);return{x:0+e*a,y:c.height-40-t*s+B.minValue*s}}function ne(){const{width:e,height:t}=q.value.getBoundingClientRect();c.width=Math.round(e),c.height=Math.round(t)}function ue(e){if(e.code&&"keyw"===e.code.toLowerCase())if(B.isStarted){if(B.isStarted&&!B.isPause&&E.value&&!B.saved&&!(B.currentMoney<O.value[1]))return void te();if(!B.isPause&&E.value&&B.saved&&!_.value)return void se();B.isPause&&Z()}else B.currentMoney=B.startSum.replace(/[^0-9]/gi,""),B.currentMoney&&B.currentMoney>=B.minValue&&(Z(),e.preventDefault(),e.stopPropagation())}function ie(e){e.code&&"keyw"===e.code.toLowerCase()&&(e.preventDefault(),e.stopPropagation(),B.startSum=(B.startSum||"").replace(/[^0-9]/gi,""))}return p((()=>{const{width:e,height:t}=q.value.getBoundingClientRect();r.value=l?l.i:0,c.width=Math.round(e),c.height=Math.round(t),window.addEventListener("resize",ne),window.addEventListener("keyup",ue),B.isMount=!0})),h((()=>{window.removeEventListener("resize",ne)})),(a,s)=>(u(),i(g,null,[m("div",A,[m("div",I,[m("div",z,[x(N)?f("",!0):(u(),i("span",U," ")),x(N)&&null==x(N).sell?(u(),i("span",R,b((+x(N).buy.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):f("",!0),x(N)&&null!=x(N).sell?(u(),i("span",Y,b((+x(N).sell.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1)):f("",!0)])]),m("div",{ref:q,class:"graph-container"},[K,(u(),i("svg",{class:"graph",width:x(c).width+10,height:x(c).height,viewBox:`${x(c).x} ${x(c).y} ${x(c).width+10} ${x(c).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${x(c).height}, ${x(c).width} ${x(c).height}`},null,8,["d"]),(u(!0),i(g,null,k(x($),(e=>(u(),i(g,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${x(c).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},b(e.value<1?(+e.value.toFixed(2)).toLocaleString("ru"):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${x(c).height}, 0 0`},null,8,["d"]),(u(!0),i(g,null,k(x(L),((e,t)=>(u(),i(g,{key:t},[m("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:x(c).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),m("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"])],64)))),128)),m("path",{class:["line-path",{"is-animate":E.value}],style:{opacity:x(B).isStarted?1:0,transition:x(B).isStarted?1.5*x(o)+"s":void 0},"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",d:x(F)},null,14,["d"]),(u(!0),i(g,null,k(x(L),((e,t)=>(u(),i(g,{key:t},[m("circle",{cx:e.x,cy:e.y,r:"5",class:["point-circle",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},null,10,["cx","cy"]),m("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:["point-text",{"buy-point":"buy"===e.type,"sell-point":"sell"===e.type}]},b((+e.value.toFixed(2)).toLocaleString("ru")),11,["x","y"])],64)))),128))],8,["width","height","viewBox"]))],512)]),m("div",G,b(e.year)+" год",1),m("div",H,[m("div",J,[x(_)?(u(),i("div",Q,[m("div",W,b((+x(B).currentMoney.toFixed(2)).toLocaleString("ru")+(t.currency?" "+t.currency:" ₽")),1),x(B).lastBuy.delta?(u(),i("div",{key:0,class:["current-diff",{up:x(B).lastBuy.delta>0,down:x(B).lastBuy.delta<0}]},[x(B).lastBuy.delta?(u(),i("div",{key:0,class:["arrow",{up:x(B).lastBuy.delta>0,down:x(B).lastBuy.delta<0}]},null,2)):f("",!0),w(" "+b((+Math.abs(x(B).lastBuy.delta).toFixed(2)).toLocaleString("ru"))+" "+b(t.currency?" "+t.currency:" ₽"),1)],2)):f("",!0)])):f("",!0),x(B).isStarted?f("",!0):(u(),i("form",{key:1,onSubmit:S(Z,["prevent"]),style:{position:"relative"}},[P(m("input",{type:"text",class:"text-input","onUpdate:modelValue":s[1]||(s[1]=e=>x(B).startSum=e),onKeydown:ie,placeholder:"Ваша сумма "+(t.currency?" "+t.currency:" ₽")},null,40,["placeholder"]),[[M,x(B).startSum]]),m("button",{disabled:!(x(B).startSum&&x(B).startSum>=x(B).minValue&&x(B).isMount),type:"submit",class:"button"}," Старт ",8,["disabled"])],40,["onSubmit"])),P(m("button",{class:"button fade-animation",style:{background:"green"},onClick:Z}," Продолжить ",512),[[V,x(B).isPause]]),E.value&&x(B).isStarted?(u(),i("div",X,[P(m("button",{class:"button fade-animation",style:{background:"green"},onClick:te,disabled:x(B).startSum<x(O)[1]}," Купить ",8,["disabled"]),[[V,E.value&&!x(B).saved]]),P(m("button",{class:"button fade-animation",style:{background:"red"},onClick:se}," Продать ",512),[[V,E.value&&x(B).saved&&!x(_)]])])):f("",!0)])])],64))},__scopeId:"data-v-d7c4ac32"};const ee=L();c("data-v-5e594ec5");const te={class:"app-container"},ae={class:"header"},se={class:"container"},le={key:0,class:"title-container"},ne={class:"subtitle"},ue={class:"container"};o();const ie={expose:[],setup(e){const t=j(),a=y({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75,emptyPoints:null});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=d(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),l=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];const u=s.map(((e,t,s)=>{const n=null!=l[t]?l[t]:null;return a.isBucks&&null!==n?n*a.bucksCourse:n})),i=u.findIndex((e=>null!==e));a.emptyPoints=-1!==i?{i:i,value:u[i]}:null,a.points.push(...s.map(((e,t,s)=>{const u=null!=l[t]?l[t]:n;return n=u,[t,a.isBucks?u*a.bucksCourse:u]})))}async function c(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=e.time||40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===t.params.id)),!l.value)return Promise.reject();a.currency=l.value.currency,a.isBucks=l.value.isBucks,await n(l.value.file)}catch(e){console.log(e)}}return $((()=>{c()})),C((()=>t.params.id),(e=>{a.points=[],O((()=>{c()}))})),(e,s)=>{const n=r("router-link");return u(),i(F,{name:"fade",appear:""},{default:ee((()=>[m("div",te,[m("header",ae,[m("div",se,[m(n,{class:"back-btn",to:x(t).query.from||"/"},null,8,["to"]),x(l)?(u(),i("div",le,[m("div",null,b(x(l).title),1),m("div",ne,b(x(l).short),1)])):f("",!0)])]),m("div",ue,[x(a).points&&x(a).points.length?(u(),i(Z,{points:x(a).points,duration:x(a).duration,id:x(t).params.id,key:x(t).params.id,currency:x(a).currency,year:x(l).year,emptyPoints:x(a).emptyPoints},null,8,["points","duration","id","currency","year","emptyPoints"])):f("",!0)])])])),_:1})}},__scopeId:"data-v-5e594ec5"};const re=L();c("data-v-029f72ae");const ce={class:"container"},oe=m("h1",{class:"h1"},"Выберите компанию",-1),de={class:"items is-full"},ye=m("h1",{class:"h1"},"Выберите компании",-1),ve={key:0,class:"items"};o();const pe={expose:[],setup(e){const t=j(),a=N();const s=y({items:[],isFullscreen:E.isFullscreen,selected:[],preSelected:[]}),l=v((()=>s.selected&&s.selected.length>0)),n=v((()=>s.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),c=v((()=>s.items.filter((e=>-1!==s.selected.indexOf(e.file)))));function o(){a.push({query:{selected:s.preSelected}}),s.selected=s.preSelected,s.preSelected=[]}function d(){E.isEnabled&&(s.isFullscreen=!E.isFullscreen,E.toggle())}return $((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();s.items=e.sources,s.selected=t.query.selected||[]})),C((()=>t.query.selected),(e=>{s.selected=t.query.selected||[]})),(e,a)=>{const y=r("router-link");return u(),i(F,{name:"fade",appear:""},{default:re((()=>[m("div",ce,[x(l)?(u(),i(y,{key:0,class:"back-btn",to:x(t).query.from||"/"},null,8,["to"])):f("",!0),m("button",{class:["fullscreen-icon",{off:x(s).isFullscreen}],onClick:d},null,2),x(l)&&x(s).items?(u(),i(g,{key:1},[oe,m("div",de,[(u(!0),i(g,null,k(x(c),(e=>(u(),i("div",{class:"item",style:{background:e.color},key:e.file},[m(y,{to:{path:`/${e.file}`,query:{from:x(t).fullPath}}},{default:re((()=>[w(b(e.title)+" "+b(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(u(),i(g,{key:2},[ye,x(s).items?(u(),i("div",ve,[(u(!0),i(g,null,k(x(s).items,(e=>(u(),i("div",{class:["item",{selected:x(n)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:t=>function(e){-1===s.preSelected.indexOf(e)?s.preSelected.push(e):s.preSelected=s.preSelected.filter((t=>t!==e))}(e.file)},b(e.title)+" "+b(e.year),9,["onClick"])],6)))),128))])):f("",!0),x(l)?f("",!0):(u(),i("button",{key:1,type:"button",disabled:!x(s).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-029f72ae"},he=_({routes:[{path:"",component:pe},{path:"/:id",component:ie}],history:q()}),me=D(T);me.use(he),me.mount("#app");
