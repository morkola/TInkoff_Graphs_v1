var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{p as n,a as i,o as u,c,r,b as o,d,e as v,f as p,n as h,g as y,h as m,t as f,w as x,i as g,v as b,u as w,F as k,j as V,T as $,k as S,l as j,m as C,q as M,s as F,x as O,y as _,z as B,A as q,B as E,C as A,D}from"./vendor.70f2207f.js";n("data-v-5389a9ea"),i();const L={expose:[],setup:e=>(e,t)=>{const a=r("router-view");return u(),c(a)}};const P=C();n("data-v-7295c4e8");const I={class:"graph-wrapper"},T={class:"container"},z={class:"input-label"},U={class:"value-input"},R=m("button",{type:"submit"},"Рассчитать",-1),Y=M('<div class="axis-x" data-v-7295c4e8><div class="x-item" data-v-7295c4e8>Янв</div><div class="x-item" data-v-7295c4e8>Фев</div><div class="x-item" data-v-7295c4e8>Мар</div><div class="x-item" data-v-7295c4e8>Апр</div><div class="x-item" data-v-7295c4e8>Май</div><div class="x-item" data-v-7295c4e8>Июн</div><div class="x-item" data-v-7295c4e8>Июл</div><div class="x-item" data-v-7295c4e8>Авг</div><div class="x-item" data-v-7295c4e8>Сен</div><div class="x-item" data-v-7295c4e8>Окт</div><div class="x-item" data-v-7295c4e8>Ноя</div><div class="x-item" data-v-7295c4e8>Дек</div></div>',1),N={class:"footer"},G={key:0,class:"container"},H=m("h3",null,"Итоговая сумма:",-1),J={class:"current-price"};i();const K={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const n=e,{points:i,duration:r}=n;o(400),o(400),o(0),o(0);const C=o(null),M=o(null),F=d((()=>+M.value*(i[i.length-1][1]/i[0][1]))),O=d((()=>(+F.value.toFixed(2)).toLocaleString())),_=d((()=>M.value&&F.value?{value:F.value-+M.value,perc:100*(+F.value-+M.value)/+F.value}:{value:0,perc:0})),B=o(0),q=v({width:1e3,height:400,x:-30,y:0});d((()=>r/i.length));let E=v({isMount:!1,saved:null,selled:null,values:d((()=>[...i].map((e=>e[1])))),maxValue:d((()=>[...i].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:d((()=>[...i].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:d((()=>[...i].length))}),A=d((()=>[{x:0,value:E.minValue,y:E.minValue&&E.maxValue?te(0,E.minValue).y:0},{x:0,value:E.maxValue,y:E.minValue&&E.maxValue?te(0,E.maxValue).y:0},{x:0,value:E.minValue&&E.maxValue?E.minValue+(E.maxValue-E.minValue)/2:0,y:E.minValue&&E.maxValue?te(0,E.minValue+(E.maxValue-E.minValue)/2).y:0}]));const D=d((()=>i.reduce(((e,t)=>(e.push(te(t[0],t[1])),e)),[]))),L=d((()=>D.value.reduce(((e,t,a,s)=>{if(a){const l=s[a-1],n=t;e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),K=d((()=>D.value.reduce(((e,t,a,s)=>{if(a&&a<=B.value){const l=s[a-1],n=t;e+=`${l.x} ${l.y}, ${n.x} ${n.y} `}return e}),"")));d((()=>[...L.value].filter(((e,t)=>t<B.value)))),d((()=>[...i].filter(((e,t)=>e===E.saved||e===E.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))a.call(n,i)&&l(e,i,n[i]);if(t)for(var i of t(n))s.call(n,i)&&l(e,i,n[i]);return e})({value:e[1]},te(e[0],e[1])))))),d((()=>i[B.value]));const Q=o(!1);function W(e){e+1<E.steps?B.value=e+1:(Q.value=!1,null==E.selled&&(E.selled=i[E.steps-1]))}const X=o(null);function Z(){Q.value=!0,ee()}function ee(){W(B.value),Q.value&&h((()=>{ee()}))}function te(e,t){const a=(q.width-35-0)/E.steps,s=(q.height-80-20)/(E.maxValue-E.minValue);return{x:0+e*a,y:q.height-40-t*s+E.minValue*s}}function ae(){const{width:e,height:t}=X.value.getBoundingClientRect();q.width=Math.round(e),q.height=Math.round(t)}function se(){M.value=C.value,document.activeElement.blur()}return p((()=>{const{width:e,height:t}=X.value.getBoundingClientRect();B.value=0,q.width=Math.round(e),q.height=Math.round(t),window.addEventListener("resize",ae),h((()=>{Z()}))})),y((()=>{window.removeEventListener("resize",ae)})),(e,t)=>(u(),c(k,null,[m("div",I,[m("div",T,[m("span",z," Введите вашу сумму, "+f(n.currency?" "+n.currency:" ₽"),1),m("form",{onSubmit:x(se,["prevent"]),class:"input-form"},[m("label",U,[g(m("input",{class:"input-text",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>C.value=e)},null,512),[[b,C.value]])]),R],40,["onSubmit"])]),m("div",{ref:X,class:"graph-container"},[Y,(u(),c("svg",{class:"graph",width:w(q).width+1,height:w(q).height,viewBox:`${w(q).x} ${w(q).y} ${w(q).width+1} ${w(q).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${w(q).height}, ${w(q).width} ${w(q).height}`},null,8,["d"]),(u(!0),c(k,null,V(w(A),(e=>(u(),c(k,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${w(q).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},f(e.value<1?+e.value.toFixed(2):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${w(q).height}, 0 0`},null,8,["d"]),m("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:w(K)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),m("div",N,[m($,{name:"fade",appear:""},{default:P((()=>[M.value?(u(),c("div",G,[H,m("div",J,f(w(O))+" "+f(n.currency?" "+n.currency:" ₽"),1),w(_)&&w(_).value?(u(),c("div",{key:0,class:["current-diff",{up:w(_).value>0,down:w(_).value<0}]},[0!==w(_).value?(u(),c("div",{key:0,class:["arrow",{up:w(_).value>0,down:w(_).value<0}]},null,2)):S("",!0),j(" "+f((+Math.abs(w(_).value).toFixed(2)).toLocaleString())+" "+f(n.currency?" "+n.currency:" ₽")+" ("+f(+Math.abs(w(_).perc).toFixed(2))+"%) ",1)],2)):S("",!0)])):S("",!0)])),_:1})])],64))},__scopeId:"data-v-7295c4e8"};const Q=C();n("data-v-49bb6a60");const W={class:"app-container"},X={class:"container"},Z={key:0,class:"title-container"},ee={class:"subtitle"},te={class:"container"};i();const ae={expose:[],setup(e){const t=_(),a=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=o(null);async function n(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),l=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{});let n=t[0]["<CLOSE>"];a.points.push(...s.map(((e,t,s)=>{const i=null!=l[t]?l[t]:n;return n=i,[t,a.isBucks?i*a.bucksCourse:i]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=null!=e.time?e.time:40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===t.params.id)),!l.value)return Promise.reject();a.currency=l.value.currency,a.isBucks=l.value.isBucks,await n(l.value.file)}catch(e){console.log(e)}}return F((()=>{i()})),O((()=>t.params.id),(e=>{a.points=[],h((()=>{i()}))})),(e,s)=>{const n=r("router-link");return u(),c($,{name:"fade",appear:""},{default:Q((()=>[m("div",W,[m("header",{class:"header",style:{background:w(l)?w(l).color:void 0}},[m("div",X,[m(n,{class:"back-btn",to:w(t).query.from||"/"},null,8,["to"]),w(l)?(u(),c("div",Z,[m("div",null,f(w(l).title),1),m("div",ee,f(w(l).short)+" "+f(w(l).year),1)])):S("",!0)])],4),m("div",te,[w(a).points&&w(a).points.length?(u(),c(K,{points:w(a).points,duration:w(a).duration,id:w(t).params.id,key:w(t).params.id,currency:w(a).currency},null,8,["points","duration","id","currency"])):S("",!0)])])])),_:1})}},__scopeId:"data-v-49bb6a60"};const se=C();n("data-v-d2476932");const le={class:"container"},ne=m("h1",{class:"h1"},"Выберите компанию",-1),ie={class:"items"},ue=m("h1",{class:"h1"},"Выберите компании",-1),ce={key:0,class:"items"};i();const re={expose:[],setup(e){const t=_(),a=q();const s=v({items:[],isFullscreen:B.isFullscreen,selected:[],preSelected:[]}),l=d((()=>s.selected&&s.selected.length>0)),n=d((()=>s.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),i=d((()=>s.items.filter((e=>-1!==s.selected.indexOf(e.file)))));function o(){a.push({query:{selected:s.preSelected}}),s.selected=s.preSelected,s.preSelected=[]}function p(){B.isEnabled&&(s.isFullscreen=!B.isFullscreen,B.toggle())}return F((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();s.items=e.sources,s.selected=t.query.selected||[]})),O((()=>t.query.selected),(e=>{s.selected=t.query.selected||[]})),(e,a)=>{const d=r("router-link");return u(),c($,{name:"fade",appear:""},{default:se((()=>[m("div",le,[w(l)?(u(),c(d,{key:0,class:"back-btn",to:w(t).query.from||"/"},null,8,["to"])):S("",!0),m("button",{class:["fullscreen-icon",{off:w(s).isFullscreen}],onClick:p},null,2),w(l)&&w(s).items?(u(),c(k,{key:1},[ne,m("div",ie,[(u(!0),c(k,null,V(w(i),(e=>(u(),c("div",{class:"item",style:{background:e.color},key:e.file},[m(d,{to:{path:`/${e.file}`,query:{from:w(t).fullPath}}},{default:se((()=>[j(f(e.title)+" "+f(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(u(),c(k,{key:2},[ue,w(s).items?(u(),c("div",ce,[(u(!0),c(k,null,V(w(s).items,(e=>(u(),c("div",{class:["item",{selected:w(n)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:t=>function(e){-1===s.preSelected.indexOf(e)?s.preSelected.push(e):s.preSelected=s.preSelected.filter((t=>t!==e))}(e.file)},f(e.title)+" "+f(e.year),9,["onClick"])],6)))),128))])):S("",!0),w(l)?S("",!0):(u(),c("button",{key:1,type:"button",disabled:!w(s).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-d2476932"},oe=E({routes:[{path:"",component:re},{path:"/:id",component:ae}],history:A()}),de=D(L);de.use(oe),de.mount("#app");
