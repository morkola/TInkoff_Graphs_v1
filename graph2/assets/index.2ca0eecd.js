var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{o as n,c as i,r as u,p as c,a as r,b as o,d,e as v,f as p,n as h,g as m,h as y,t as f,w as b,i as x,v as g,u as w,F as k,j as V,T as $,k as S,l as j,m as C,q as M,s as P,x as F,y as O,z as B,A as _,B as q,C as E,D as A}from"./vendor.70f2207f.js";const D={expose:[],setup:e=>(e,t)=>{const a=u("router-view");return n(),i(a)}};const L=C();c("data-v-25be18fe");const I={class:"graph-wrapper"},T={class:"container"},z={class:"input-label"},U={class:"value-input"},R=M('<div class="axis-x" data-v-25be18fe><div class="x-item" data-v-25be18fe>Янв</div><div class="x-item" data-v-25be18fe>Фев</div><div class="x-item" data-v-25be18fe>Мар</div><div class="x-item" data-v-25be18fe>Апр</div><div class="x-item" data-v-25be18fe>Май</div><div class="x-item" data-v-25be18fe>Июн</div><div class="x-item" data-v-25be18fe>Июл</div><div class="x-item" data-v-25be18fe>Авг</div><div class="x-item" data-v-25be18fe>Сен</div><div class="x-item" data-v-25be18fe>Окт</div><div class="x-item" data-v-25be18fe>Ноя</div><div class="x-item" data-v-25be18fe>Дек</div></div>',1),Y={class:"footer"},N={key:0,class:"container"},G=y("h3",null,"Итоговая сумма:",-1),H={class:"current-price"};r();const J={expose:[],props:{points:Array,duration:Number,id:String,currency:String,emptyPoints:Object},setup(e){const u=e,{points:c,duration:r,emptyPoints:C}=u;o(400),o(400),o(0),o(0);const M=o(null),P=o(null),F=d((()=>P.value?Math.ceil(P.value/c[0][1]):0)),O=d((()=>P.value-F.value*c[0][1])),B=d((()=>(P.value-O.value)*(c[c.length-1][1]/c[0][1])+O.value)),_=d((()=>(+B.value.toFixed(2)).toLocaleString("ru"))),q=d((()=>P.value&&B.value?{value:B.value-+P.value,perc:100*(+B.value-+P.value)/+B.value}:{value:0,perc:0})),E=o(0),A=v({width:1e3,height:400,x:-30,y:0});d((()=>r/c.length));let D=v({isMount:!1,saved:null,selled:null,values:d((()=>[...c].map((e=>e[1])))),maxValue:d((()=>[...c].reduce(((e,t)=>null===e||+t[1]>e?+t[1]:e),null))),minValue:d((()=>[...c].reduce(((e,t)=>null===e||e>t[1]?t[1]:e),null))),steps:d((()=>[...c].length))}),J=d((()=>[{x:0,value:D.minValue,y:D.minValue&&D.maxValue?le(0,D.minValue).y:0},{x:0,value:D.maxValue,y:D.minValue&&D.maxValue?le(0,D.maxValue).y:0},{x:0,value:D.minValue&&D.maxValue?D.minValue+(D.maxValue-D.minValue)/2:0,y:D.minValue&&D.maxValue?le(0,D.minValue+(D.maxValue-D.minValue)/2).y:0}]));const K=d((()=>c.reduce(((e,t)=>(e.push(le(t[0],t[1])),e)),[]))),Q=d((()=>K.value.reduce(((e,t,a,l)=>{if(a){const s=l[a-1],n=t;e.push(`M${s.x} ${s.y}, ${n.x} ${n.y}`)}return e}),[]))),W=d((()=>K.value.reduce(((e,t,a,l)=>{if(a&&a<=E.value&&!(C&&a<=C.i)){const s=l[a-1],n=t;e+=`${s.x} ${s.y}, ${n.x} ${n.y} `}return e}),"")));d((()=>[...Q.value].filter(((e,t)=>t<E.value)))),d((()=>[...c].filter(((e,t)=>e===D.saved||e===D.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))a.call(n,i)&&s(e,i,n[i]);if(t)for(var i of t(n))l.call(n,i)&&s(e,i,n[i]);return e})({value:e[1]},le(e[0],e[1])))))),d((()=>c[E.value]));const X=o(!1);function Z(e){e+1<D.steps?E.value=e+1:(X.value=!1,null==D.selled&&(D.selled=c[D.steps-1]))}const ee=o(null);function te(){X.value=!0,ae()}function ae(){Z(E.value),X.value&&h((()=>{ae()}))}function le(e,t){const a=(A.width-35-0)/D.steps,l=(A.height-80-20)/(D.maxValue-D.minValue);return{x:0+e*a,y:A.height-40-t*l+D.minValue*l}}function se(){const{width:e,height:t}=ee.value.getBoundingClientRect();A.width=Math.round(e),A.height=Math.round(t)}function ne(){P.value=M.value,document.activeElement.blur()}return p((()=>{const{width:e,height:t}=ee.value.getBoundingClientRect();E.value=0,A.width=Math.round(e),A.height=Math.round(t),window.addEventListener("resize",se),h((()=>{te()}))})),m((()=>{window.removeEventListener("resize",se)})),(e,t)=>(n(),i(k,null,[y("div",I,[y("div",T,[y("span",z," Введите вашу сумму, "+f(u.currency?" "+u.currency:" ₽"),1),y("form",{onSubmit:b(ne,["prevent"]),class:"input-form"},[y("label",U,[x(y("input",{class:"input-text",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e)},null,512),[[g,M.value]])]),y("button",{type:"submit",class:"button",disabled:!(null!=M.value&&M.value>w(D).minValue)}," Рассчитать ",8,["disabled"])],40,["onSubmit"])]),y("div",{ref:ee,class:"graph-container"},[R,(n(),i("svg",{class:"graph",width:w(A).width+1,height:w(A).height,viewBox:`${w(A).x} ${w(A).y} ${w(A).width+1} ${w(A).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[y("path",{class:"axis",d:`M0 ${w(A).height}, ${w(A).width} ${w(A).height}`},null,8,["d"]),(n(!0),i(k,null,V(w(J),(e=>(n(),i(k,{key:e.value},[y("path",{class:"y-line",d:`M0 ${e.y}, ${w(A).width} ${e.y}`},null,8,["d"]),y("text",{x:"-25",y:e.y+4,class:"y-text"},f(e.value<1?+e.value.toFixed(2):Math.round(e.value)),9,["y"])],64)))),128)),y("path",{class:"axis",d:`M0 ${w(A).height}, 0 0`},null,8,["d"]),y("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:w(W)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),y("div",Y,[y($,{name:"fade",appear:""},{default:L((()=>[P.value?(n(),i("div",N,[G,y("div",H,f(w(_))+" "+f(u.currency?" "+u.currency:" ₽"),1),w(q)&&w(q).value?(n(),i("div",{key:0,class:["current-diff",{up:w(q).value>0,down:w(q).value<0}]},[0!==w(q).value?(n(),i("div",{key:0,class:["arrow",{up:w(q).value>0,down:w(q).value<0}]},null,2)):S("",!0),j(" "+f((+Math.abs(w(q).value).toFixed(2)).toLocaleString("ru"))+" "+f(u.currency?" "+u.currency:" ₽"),1)],2)):S("",!0)])):S("",!0)])),_:1})])],64))},__scopeId:"data-v-25be18fe"};const K=C();c("data-v-d356e580");const Q={class:"app-container"},W={class:"header"},X={class:"container"},Z={key:0,class:"title-container"},ee={class:"subtitle"},te={class:"container"};r();const ae={expose:[],setup(e){const t=O(),a=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75,emptyPoints:null});let l=[[0,10],[10,30],[20,20],[30,50],[40,20]];l=new Array(365),l.fill([0,0]);let s=o(null);async function c(e){const t=await fetch(`data/${e}.json`).then((e=>e.json())),s=t.reduce(((e,t)=>{var a;return e[(a=new Date(t["<DATE>"]),(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(a.getFullYear(),0,0))/24/60/60/1e3)-1]=t["<CLOSE>"],e}),{}),n=l.map(((e,t,l)=>{const n=null!=s[t]?s[t]:null;return a.isBucks&&null!==n?n*a.bucksCourse:n})),i=n.findIndex((e=>null!==e));a.emptyPoints=-1!==i?{i:i,value:n[i]}:null;let u=t[0]["<CLOSE>"];a.points.push(...l.map(((e,t,l)=>{const n=null!=s[t]?s[t]:u;return u=n,[t,a.isBucks?n*a.bucksCourse:n]})))}async function r(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(a.duration=null!=e.time?e.time:40,a.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(s.value=e.sources.find((e=>e.file===t.params.id)),!s.value)return Promise.reject();a.currency=s.value.currency,a.isBucks=s.value.isBucks,await c(s.value.file)}catch(e){console.log(e)}}return P((()=>{r()})),F((()=>t.params.id),(e=>{a.points=[],h((()=>{r()}))})),(e,l)=>{const c=u("router-link");return n(),i($,{name:"fade",appear:""},{default:K((()=>[y("div",Q,[y("header",W,[y("div",X,[y(c,{class:"back-btn",to:w(t).query.from||"/"},null,8,["to"]),w(s)?(n(),i("div",Z,[y("div",null,f(w(s).title),1),y("div",ee,f(w(s).short)+" "+f(w(s).year),1)])):S("",!0)])]),y("div",te,[w(a).points&&w(a).points.length?(n(),i(J,{points:w(a).points,duration:w(a).duration,id:w(t).params.id,key:w(t).params.id,currency:w(a).currency,emptyPoints:w(a).emptyPoints},null,8,["points","duration","id","currency","emptyPoints"])):S("",!0)])])])),_:1})}},__scopeId:"data-v-d356e580"};const le=C();c("data-v-aa80605c");const se={class:"container"},ne=y("h1",{class:"h1"},"Выберите компанию",-1),ie={class:"items is-full"},ue=y("h1",{class:"h1"},"Выберите компании",-1),ce={key:0,class:"items"};r();const re={expose:[],setup(e){const t=O(),a=_();const l=v({items:[],isFullscreen:B.isFullscreen,selected:[],preSelected:[]}),s=d((()=>l.selected&&l.selected.length>0)),c=d((()=>l.preSelected.reduce(((e,t)=>(e[t]=t,e)),{}))),r=d((()=>l.items.filter((e=>-1!==l.selected.indexOf(e.file)))));function o(){a.push({query:{selected:l.preSelected}}),l.selected=l.preSelected,l.preSelected=[]}function p(){B.isEnabled&&(l.isFullscreen=!B.isFullscreen,B.toggle())}return P((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();l.items=e.sources,l.selected=t.query.selected||[]})),F((()=>t.query.selected),(e=>{l.selected=t.query.selected||[]})),(e,a)=>{const d=u("router-link");return n(),i($,{name:"fade",appear:""},{default:le((()=>[y("div",se,[w(s)?(n(),i(d,{key:0,class:"back-btn",to:w(t).query.from||"/"},null,8,["to"])):S("",!0),y("button",{class:["fullscreen-icon",{off:w(l).isFullscreen}],onClick:p},null,2),w(s)&&w(l).items?(n(),i(k,{key:1},[ne,y("div",ie,[(n(!0),i(k,null,V(w(r),(e=>(n(),i("div",{class:"item",style:{background:e.color},key:e.file},[y(d,{to:{path:`/${e.file}`,query:{from:w(t).fullPath}}},{default:le((()=>[j(f(e.title)+" "+f(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(n(),i(k,{key:2},[ue,w(l).items?(n(),i("div",ce,[(n(!0),i(k,null,V(w(l).items,(e=>(n(),i("div",{class:["item",{selected:w(c)[e.file]}],style:{background:e.color},key:e.file},[y("button",{type:"button",onClick:t=>function(e){-1===l.preSelected.indexOf(e)?l.preSelected.push(e):l.preSelected=l.preSelected.filter((t=>t!==e))}(e.file)},f(e.title)+" "+f(e.year),9,["onClick"])],6)))),128))])):S("",!0),w(s)?S("",!0):(n(),i("button",{key:1,type:"button",disabled:!w(l).preSelected.length,class:"button start-btn",onClick:o}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-aa80605c"},oe=q({routes:[{path:"",component:re},{path:"/:id",component:ae}],history:E()}),de=A(D);de.use(oe),de.mount("#app");
