var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l;import{o as n,c as i,r as u,p as c,a as r,b as d,d as o,e as v,f as p,n as h,g as y,h as m,t as f,w as x,i as g,v as b,u as w,F as k,j as V,T as $,k as S,l as j,m as C,q as M,s as F,x as O,y as _,z as B,A as q,B as E,C as L,D as A}from"./vendor.70f2207f.js";const D={expose:[],setup:e=>(e,a)=>{const t=u("router-view");return n(),i(t)}};const P=C();c("data-v-2d7ace46");const I={class:"graph-wrapper"},T={class:"container"},z={class:"input-label"},U={class:"value-input"},R=M('<div class="axis-x" data-v-2d7ace46><div class="x-item" data-v-2d7ace46>Янв</div><div class="x-item" data-v-2d7ace46>Фев</div><div class="x-item" data-v-2d7ace46>Мар</div><div class="x-item" data-v-2d7ace46>Апр</div><div class="x-item" data-v-2d7ace46>Май</div><div class="x-item" data-v-2d7ace46>Июн</div><div class="x-item" data-v-2d7ace46>Июл</div><div class="x-item" data-v-2d7ace46>Авг</div><div class="x-item" data-v-2d7ace46>Сен</div><div class="x-item" data-v-2d7ace46>Окт</div><div class="x-item" data-v-2d7ace46>Ноя</div><div class="x-item" data-v-2d7ace46>Дек</div></div>',1),Y={class:"footer"},N={key:0,class:"container"},G=m("h3",null,"Итоговая сумма:",-1),H={class:"current-price"};r();const J={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const u=e,{points:c,duration:r}=u;d(400),d(400),d(0),d(0);const C=d(null),M=d(null),F=o((()=>M.value?Math.ceil(M.value/c[0][1]):0)),O=o((()=>M.value-F.value*c[0][1])),_=o((()=>(M.value-O.value)*(c[c.length-1][1]/c[0][1])+O.value)),B=o((()=>(+_.value.toFixed(2)).toLocaleString("ru"))),q=o((()=>M.value&&_.value?{value:_.value-+M.value,perc:100*(+_.value-+M.value)/+_.value}:{value:0,perc:0})),E=d(0),L=v({width:1e3,height:400,x:-30,y:0});o((()=>r/c.length));let A=v({isMount:!1,saved:null,selled:null,values:o((()=>[...c].map((e=>e[1])))),maxValue:o((()=>[...c].reduce(((e,a)=>null===e||+a[1]>e?+a[1]:e),null))),minValue:o((()=>[...c].reduce(((e,a)=>null===e||e>a[1]?a[1]:e),null))),steps:o((()=>[...c].length))}),D=o((()=>[{x:0,value:A.minValue,y:A.minValue&&A.maxValue?te(0,A.minValue).y:0},{x:0,value:A.maxValue,y:A.minValue&&A.maxValue?te(0,A.maxValue).y:0},{x:0,value:A.minValue&&A.maxValue?A.minValue+(A.maxValue-A.minValue)/2:0,y:A.minValue&&A.maxValue?te(0,A.minValue+(A.maxValue-A.minValue)/2).y:0}]));const J=o((()=>c.reduce(((e,a)=>(e.push(te(a[0],a[1])),e)),[]))),K=o((()=>J.value.reduce(((e,a,t,l)=>{if(t){const s=l[t-1],n=a;e.push(`M${s.x} ${s.y}, ${n.x} ${n.y}`)}return e}),[]))),Q=o((()=>J.value.reduce(((e,a,t,l)=>{if(t&&t<=E.value){const s=l[t-1],n=a;e+=`${s.x} ${s.y}, ${n.x} ${n.y} `}return e}),"")));o((()=>[...K.value].filter(((e,a)=>a<E.value)))),o((()=>[...c].filter(((e,a)=>e===A.saved||e===A.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))t.call(n,i)&&s(e,i,n[i]);if(a)for(var i of a(n))l.call(n,i)&&s(e,i,n[i]);return e})({value:e[1]},te(e[0],e[1])))))),o((()=>c[E.value]));const W=d(!1);function X(e){e+1<A.steps?E.value=e+1:(W.value=!1,null==A.selled&&(A.selled=c[A.steps-1]))}const Z=d(null);function ee(){W.value=!0,ae()}function ae(){X(E.value),W.value&&h((()=>{ae()}))}function te(e,a){const t=(L.width-35-0)/A.steps,l=(L.height-80-20)/(A.maxValue-A.minValue);return{x:0+e*t,y:L.height-40-a*l+A.minValue*l}}function le(){const{width:e,height:a}=Z.value.getBoundingClientRect();L.width=Math.round(e),L.height=Math.round(a)}function se(){M.value=C.value,document.activeElement.blur()}return p((()=>{const{width:e,height:a}=Z.value.getBoundingClientRect();E.value=0,L.width=Math.round(e),L.height=Math.round(a),window.addEventListener("resize",le),h((()=>{ee()}))})),y((()=>{window.removeEventListener("resize",le)})),(e,a)=>(n(),i(k,null,[m("div",I,[m("div",T,[m("span",z," Введите вашу сумму, "+f(u.currency?" "+u.currency:" ₽"),1),m("form",{onSubmit:x(se,["prevent"]),class:"input-form"},[m("label",U,[g(m("input",{class:"input-text",type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>C.value=e)},null,512),[[b,C.value]])]),m("button",{type:"submit",class:"button",disabled:!(null!=C.value&&C.value>w(A).minValue)}," Рассчитать ",8,["disabled"])],40,["onSubmit"])]),m("div",{ref:Z,class:"graph-container"},[R,(n(),i("svg",{class:"graph",width:w(L).width+1,height:w(L).height,viewBox:`${w(L).x} ${w(L).y} ${w(L).width+1} ${w(L).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[m("path",{class:"axis",d:`M0 ${w(L).height}, ${w(L).width} ${w(L).height}`},null,8,["d"]),(n(!0),i(k,null,V(w(D),(e=>(n(),i(k,{key:e.value},[m("path",{class:"y-line",d:`M0 ${e.y}, ${w(L).width} ${e.y}`},null,8,["d"]),m("text",{x:"-25",y:e.y+4,class:"y-text"},f(e.value<1?+e.value.toFixed(2):Math.round(e.value)),9,["y"])],64)))),128)),m("path",{class:"axis",d:`M0 ${w(L).height}, 0 0`},null,8,["d"]),m("polyline",{class:"line-path","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",points:w(Q)},null,8,["points"])],8,["width","height","viewBox"]))],512)]),m("div",Y,[m($,{name:"fade",appear:""},{default:P((()=>[M.value?(n(),i("div",N,[G,m("div",H,f(w(B))+" "+f(u.currency?" "+u.currency:" ₽"),1),w(q)&&w(q).value?(n(),i("div",{key:0,class:["current-diff",{up:w(q).value>0,down:w(q).value<0}]},[0!==w(q).value?(n(),i("div",{key:0,class:["arrow",{up:w(q).value>0,down:w(q).value<0}]},null,2)):S("",!0),j(" "+f((+Math.abs(w(q).value).toFixed(2)).toLocaleString("ru"))+" "+f(u.currency?" "+u.currency:" ₽")+" ("+f((+Math.abs(w(q).perc).toFixed(2)).toLocaleString("ru"))+"%) ",1)],2)):S("",!0)])):S("",!0)])),_:1})])],64))},__scopeId:"data-v-2d7ace46"};const K=C();c("data-v-5aac3808");const Q={class:"app-container"},W={class:"container"},X={key:0,class:"title-container"},Z={class:"subtitle"},ee={class:"container"};r();const ae={expose:[],setup(e){const a=_(),t=v({points:[],duration:40,currency:"",isBucks:!1,bucksCourse:75});let l=[[0,10],[10,30],[20,20],[30,50],[40,20]];l=new Array(365),l.fill([0,0]);let s=d(null);async function c(e){const a=await fetch(`data/${e}.json`).then((e=>e.json())),s=a.reduce(((e,a)=>{var t;return e[(t=new Date(a["<DATE>"]),(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-Date.UTC(t.getFullYear(),0,0))/24/60/60/1e3)-1]=a["<CLOSE>"],e}),{});let n=a[0]["<CLOSE>"];t.points.push(...l.map(((e,a,l)=>{const i=null!=s[a]?s[a]:n;return n=i,[a,t.isBucks?i*t.bucksCourse:i]})))}async function r(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(t.duration=null!=e.time?e.time:40,t.bucksCourse=e.bucksCourse||75,!Array.isArray(e.sources))return Promise.reject();if(s.value=e.sources.find((e=>e.file===a.params.id)),!s.value)return Promise.reject();t.currency=s.value.currency,t.isBucks=s.value.isBucks,await c(s.value.file)}catch(e){console.log(e)}}return F((()=>{r()})),O((()=>a.params.id),(e=>{t.points=[],h((()=>{r()}))})),(e,l)=>{const c=u("router-link");return n(),i($,{name:"fade",appear:""},{default:K((()=>[m("div",Q,[m("header",{class:"header",style:{background:w(s)?w(s).color:void 0}},[m("div",W,[m(c,{class:"back-btn",to:w(a).query.from||"/"},null,8,["to"]),w(s)?(n(),i("div",X,[m("div",null,f(w(s).title),1),m("div",Z,f(w(s).short)+" "+f(w(s).year),1)])):S("",!0)])],4),m("div",ee,[w(t).points&&w(t).points.length?(n(),i(J,{points:w(t).points,duration:w(t).duration,id:w(a).params.id,key:w(a).params.id,currency:w(t).currency},null,8,["points","duration","id","currency"])):S("",!0)])])])),_:1})}},__scopeId:"data-v-5aac3808"};const te=C();c("data-v-9b877188");const le={class:"container"},se=m("h1",{class:"h1"},"Выберите компанию",-1),ne={class:"items is-full"},ie=m("h1",{class:"h1"},"Выберите компании",-1),ue={key:0,class:"items"};r();const ce={expose:[],setup(e){const a=_(),t=q();const l=v({items:[],isFullscreen:B.isFullscreen,selected:[],preSelected:[]}),s=o((()=>l.selected&&l.selected.length>0)),c=o((()=>l.preSelected.reduce(((e,a)=>(e[a]=a,e)),{}))),r=o((()=>l.items.filter((e=>-1!==l.selected.indexOf(e.file)))));function d(){t.push({query:{selected:l.preSelected}}),l.selected=l.preSelected,l.preSelected=[]}function p(){B.isEnabled&&(l.isFullscreen=!B.isFullscreen,B.toggle())}return F((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();l.items=e.sources,l.selected=a.query.selected||[]})),O((()=>a.query.selected),(e=>{l.selected=a.query.selected||[]})),(e,t)=>{const o=u("router-link");return n(),i($,{name:"fade",appear:""},{default:te((()=>[m("div",le,[w(s)?(n(),i(o,{key:0,class:"back-btn",to:w(a).query.from||"/"},null,8,["to"])):S("",!0),m("button",{class:["fullscreen-icon",{off:w(l).isFullscreen}],onClick:p},null,2),w(s)&&w(l).items?(n(),i(k,{key:1},[se,m("div",ne,[(n(!0),i(k,null,V(w(r),(e=>(n(),i("div",{class:"item",style:{background:e.color},key:e.file},[m(o,{to:{path:`/${e.file}`,query:{from:w(a).fullPath}}},{default:te((()=>[j(f(e.title)+" "+f(e.year),1)])),_:2},1032,["to"])],4)))),128))])],64)):(n(),i(k,{key:2},[ie,w(l).items?(n(),i("div",ue,[(n(!0),i(k,null,V(w(l).items,(e=>(n(),i("div",{class:["item",{selected:w(c)[e.file]}],style:{background:e.color},key:e.file},[m("button",{type:"button",onClick:a=>function(e){-1===l.preSelected.indexOf(e)?l.preSelected.push(e):l.preSelected=l.preSelected.filter((a=>a!==e))}(e.file)},f(e.title)+" "+f(e.year),9,["onClick"])],6)))),128))])):S("",!0),w(s)?S("",!0):(n(),i("button",{key:1,type:"button",disabled:!w(l).preSelected.length,class:"button start-btn",onClick:d}," Далее ",8,["disabled"]))],64))])])),_:1})}},__scopeId:"data-v-9b877188"},re=E({routes:[{path:"",component:ce},{path:"/:id",component:ae}],history:L()}),de=A(D);de.use(re),de.mount("#app");
