var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{p as n,a as i,o as r,c,r as u,b as d,d as o,e as v,f as y,n as h,g as p,h as x,t as m,u as g,i as f,F as w,j as k,k as b,l as V,w as $,m as j,s as M,q as C,v as F,x as O,y as _,z as E,V as A}from"./vendor.1a748cc0.js";n("data-v-5389a9ea"),i();const D={expose:[],setup:e=>(e,a)=>{const t=u("router-view");return r(),c(t)}};n("data-v-4de1a733");const L={class:"graph-wrapper"},S={class:"price"},P={class:"current-price"},T=b('<div class="axis-x" data-v-4de1a733><div class="x-item" data-v-4de1a733>Янв</div><div class="x-item" data-v-4de1a733>Фев</div><div class="x-item" data-v-4de1a733>Март</div><div class="x-item" data-v-4de1a733>Апр</div><div class="x-item" data-v-4de1a733>Май</div><div class="x-item" data-v-4de1a733>Июнь</div><div class="x-item" data-v-4de1a733>Июль</div><div class="x-item" data-v-4de1a733>Авг</div><div class="x-item" data-v-4de1a733>Сен</div><div class="x-item" data-v-4de1a733>Окт</div><div class="x-item" data-v-4de1a733>Ноя</div><div class="x-item" data-v-4de1a733>Дек</div></div>',1),B={class:"footer"},I={class:"container"};i();const z={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const n=e,{points:i,duration:u}=n;d(400),d(400),d(0);const b=d([]);d(0);const V=d(0),$=o({width:1e3,height:400,x:-30,y:0}),j=v((()=>u/i.length));let M=o({isMount:!1,saved:null,selled:null,values:v((()=>[...i].map((e=>e[1])))),maxValue:v((()=>[...i].reduce(((e,a)=>null===e||+a[1]>e?+a[1]:e),null))),minValue:v((()=>[...i].reduce(((e,a)=>null===e||e>a[1]?a[1]:e),null))),steps:v((()=>[...i].length))}),C=v((()=>[{x:0,value:M.minValue,y:M.minValue&&M.maxValue?G(0,M.minValue).y:0},{x:0,value:M.maxValue,y:M.minValue&&M.maxValue?G(0,M.maxValue).y:0},{x:0,value:M.minValue&&M.maxValue?M.minValue+(M.maxValue-M.minValue)/2:0,y:M.minValue&&M.maxValue?G(0,M.minValue+(M.maxValue-M.minValue)/2).y:0}]));const F=v((()=>i.reduce(((e,a,t,s)=>{if(t){const l=G(s[t-1][0],s[t-1][1]),n=G(a[0],a[1]);e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),O=v((()=>[...b.value].map((e=>e.getTotalLength()))));v((()=>[...F.value].filter(((e,a)=>a<V.value))));const _=v((()=>[...i].filter(((e,a)=>e===M.saved||e===M.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))t.call(n,i)&&l(e,i,n[i]);if(a)for(var i of a(n))s.call(n,i)&&l(e,i,n[i]);return e})({value:e[1]},G(e[0],e[1])))))),E=v((()=>i[V.value])),A=d(!1),D=v((()=>M.saved&&M.selled?{value:M.selled[1]-M.saved[1],perc:100*(M.selled[1]-M.saved[1])/M.saved[1]}:null));function z(e){e+1<M.steps?V.value=e+1:(A.value=!1,null==M.selled&&(M.selled=i[M.steps-1]))}const R=d(null);function U(){A.value=!0,Y()}function Y(){z(V.value),A.value&&setTimeout((()=>{Y()}),1e3*j.value)}function q(){M.saved=i[V.value]}function N(){M.selled=i[V.value]}function G(e,a){const t=($.width-35-0)/M.steps,s=($.height-80-20)/(M.maxValue-M.minValue);return{x:0+e*t,y:$.height-40-a*s+M.minValue*s}}function H(){const{width:e,height:a}=R.value.getBoundingClientRect();$.width=Math.round(e),$.height=Math.round(a)}return y((()=>{const{width:e,height:a}=R.value.getBoundingClientRect();V.value=0,$.width=Math.round(e),$.height=Math.round(a),window.addEventListener("resize",H),h((()=>{U()}))})),p((()=>{window.removeEventListener("resize",H)})),(a,t)=>(r(),c(w,null,[x("div",L,[x("div",S,[x("div",P,m(g(M).selled?g(M).selled[1].toFixed(2)+(n.currency?" "+n.currency:" ₽"):g(E)?g(E)[1].toLocaleString()+(n.currency?" "+n.currency:" ₽"):"-"),1),g(D)?(r(),c("div",{key:0,class:["current-diff",{up:g(D).value>0,down:g(D).value<0}]},m(g(D).value.toFixed(2))+" "+m(n.currency?" "+n.currency:" ₽")+" ("+m(g(D).perc.toFixed(2))+"%) ",3)):f("",!0)]),x("div",{ref:R,class:"graph-container"},[(r(),c("svg",{class:"graph",width:g($).width+10,height:g($).height,viewBox:`${g($).x} ${g($).y} ${g($).width+10} ${g($).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[x("path",{class:"axis",d:`M0 ${g($).height}, ${g($).width} ${g($).height}`},null,8,["d"]),(r(!0),c(w,null,k(g(C),(e=>(r(),c(w,{key:e.value},[x("path",{class:"y-line",d:`M0 ${e.y}, ${g($).width} ${e.y}`},null,8,["d"]),x("text",{x:"-25",y:e.y+4,class:"y-text"},m(Math.round(e.value)),9,["y"])],64)))),128)),x("path",{class:"axis",d:`M0 ${g($).height}, 0 0`},null,8,["d"]),(r(!0),c(w,null,k(g(_),((e,a)=>(r(),c(w,{key:a},[x("circle",{cx:e.x,cy:e.y,r:"5",fill:"red",class:"point-circle"},null,8,["cx","cy"]),x("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:g($).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),x("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),x("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:"point-text"},m(e.value),9,["x","y"])],64)))),128)),(r(!0),c(w,null,k(g(F),((a,t)=>(r(),c("path",{class:["line-path",{visible:t<V.value}],key:t+"_"+e.id,ref:e=>{e&&(b.value[t]=e)},d:a,style:{"stroke-dasharray":g(O)[t],"stroke-dashoffset":g(O)[t],transition:`${g(j)}s`},stroke:"black"},null,14,["d"])))),128))],8,["width","height","viewBox"]))],512),T]),x("div",B,[x("div",I,[A.value||g(M).steps-1===V.value?f("",!0):(r(),c("button",{key:0,class:"button",onClick:U}," Начать ")),A.value&&!g(M).saved?(r(),c("button",{key:1,class:"button",onClick:q}," Купить ")):f("",!0),A.value&&g(M).saved&&!g(D)?(r(),c("button",{key:2,class:"button",style:{background:"#151D2A"},onClick:N}," Продать ")):f("",!0)])])],64))},__scopeId:"data-v-4de1a733"};n("data-v-7e606970");const R={class:"app-container"},U={class:"container"},Y={key:0,class:"title-container"},q={class:"subtitle"},N={class:"container"};i();const G={expose:[],setup(e){const a=j(),t=o({points:[],duration:40,currency:"$"});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=d(null);async function n(e){const a=await fetch(`data/${e}.json`).then((e=>e.json())),l=a.reduce(((e,a)=>{var t;return e[(t=new Date(a["<DATE>"]),(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-Date.UTC(t.getFullYear(),0,0))/24/60/60/1e3)-1]=a["<CLOSE>"],e}),{});let n=a[0]["<CLOSE>"];t.points.push(...s.map(((e,a,t)=>{const s=null!=l[a]?l[a]:n;return n=s,[a,s]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(t.duration=e.time||40,console.log(t.duration),!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===a.params.id)),!l.value)return Promise.reject();t.currency=l.value.currency,await n(l.value.file)}catch(e){}}return V((()=>{i()})),$((()=>a.params.id),(e=>{t.points=[],h((()=>{i()}))})),(e,s)=>{const n=u("router-link");return r(),c("div",R,[x("header",{class:"header",style:{background:g(l)?g(l).color:void 0}},[x("div",U,[x(n,{class:"back-btn",to:"/"}),g(l)?(r(),c("div",Y,[x("div",null,m(g(l).title),1),x("div",q,m(g(l).short)+" "+m(g(l).year),1)])):f("",!0)])],4),x("div",N,[g(t).points&&g(t).points.length?(r(),c(z,{points:g(t).points,duration:g(t).duration,id:g(a).params.id,key:g(a).params.id,currency:g(t).currency},null,8,["points","duration","id","currency"])):f("",!0)])])}},__scopeId:"data-v-7e606970"};const H=F();n("data-v-e3a7462e");const J={class:"container"},K=x("h1",{class:"h1"},"Выберите компанию",-1),Q={key:0,class:"items"};i();const W={expose:[],setup(e){const a=o({items:[],isFullscreen:!1});function t(){M.isEnabled&&(a.isFullscreen=!M.isFullscreen,M.toggle())}return V((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();a.items=e.sources})),(e,s)=>{const l=u("router-link");return r(),c("div",J,[x("button",{class:["fullscreen-icon",{off:g(a).isFullscreen}],onClick:t},null,2),K,g(a).items?(r(),c("div",Q,[(r(!0),c(w,null,k(g(a).items,(e=>(r(),c("div",{class:"item",style:{background:e.color},key:e.file},[x(l,{to:`/${e.file}`},{default:H((()=>[C(m(e.title)+" "+m(e.year),1)])),_:2},1032,["to"])],4)))),128))])):f("",!0)])}},__scopeId:"data-v-e3a7462e"},X=O({routes:[{path:"",component:W},{path:"/:id",component:G}],history:_()}),Z=E(D);Z.use(X),Z.mount("#app"),Z.use(A);
