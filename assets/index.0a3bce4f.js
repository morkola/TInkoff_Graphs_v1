var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{p as n,a as i,o as c,c as u,r,b as o,d,e as v,f as y,n as h,g as p,h as x,u as m,t as b,i as g,F as f,j as w,k,l as V,m as $,w as j,q as M,s as F,v as C,x as O,y as _,z as E,V as A}from"./vendor.5ad8a832.js";n("data-v-5389a9ea"),i();const D={expose:[],setup:e=>(e,a)=>{const t=r("router-view");return c(),u(t)}};n("data-v-a5bb5464");const L={class:"graph-wrapper"},S={class:"price"},P={key:0,class:"current-price"},T=V('<div class="axis-x" data-v-a5bb5464><div class="x-item" data-v-a5bb5464>Янв</div><div class="x-item" data-v-a5bb5464>Фев</div><div class="x-item" data-v-a5bb5464>Март</div><div class="x-item" data-v-a5bb5464>Апр</div><div class="x-item" data-v-a5bb5464>Май</div><div class="x-item" data-v-a5bb5464>Июнь</div><div class="x-item" data-v-a5bb5464>Июль</div><div class="x-item" data-v-a5bb5464>Авг</div><div class="x-item" data-v-a5bb5464>Сен</div><div class="x-item" data-v-a5bb5464>Окт</div><div class="x-item" data-v-a5bb5464>Ноя</div><div class="x-item" data-v-a5bb5464>Дек</div></div>',1),B={class:"footer"},I={class:"container"},z={key:0,class:"price"};i();const R={expose:[],props:{points:Array,duration:Number,id:String,currency:String},setup(e){const n=e,{points:i,duration:r}=n;o(400),o(400),o(0);const V=o([]);o(0);const $=o(0),j=d({width:1e3,height:400,x:-30,y:0}),M=v((()=>r/i.length));let F=d({isMount:!1,saved:null,selled:null,values:v((()=>[...i].map((e=>e[1])))),maxValue:v((()=>[...i].reduce(((e,a)=>null===e||+a[1]>e?+a[1]:e),null))),minValue:v((()=>[...i].reduce(((e,a)=>null===e||e>a[1]?a[1]:e),null))),steps:v((()=>[...i].length))}),C=v((()=>[{x:0,value:F.minValue,y:F.minValue&&F.maxValue?J(0,F.minValue).y:0},{x:0,value:F.maxValue,y:F.minValue&&F.maxValue?J(0,F.maxValue).y:0},{x:0,value:F.minValue&&F.maxValue?F.minValue+(F.maxValue-F.minValue)/2:0,y:F.minValue&&F.maxValue?J(0,F.minValue+(F.maxValue-F.minValue)/2).y:0}]));const O=v((()=>i.reduce(((e,a,t,s)=>{if(t){const l=J(s[t-1][0],s[t-1][1]),n=J(a[0],a[1]);e.push(`M${l.x} ${l.y}, ${n.x} ${n.y}`)}return e}),[]))),_=v((()=>[...V.value].map((e=>e.getTotalLength()))));v((()=>[...O.value].filter(((e,a)=>a<$.value))));const E=v((()=>[...i].filter(((e,a)=>e===F.saved||e===F.selled)).map((e=>((e,n)=>{for(var i in n||(n={}))t.call(n,i)&&l(e,i,n[i]);if(a)for(var i of a(n))s.call(n,i)&&l(e,i,n[i]);return e})({value:e[1]},J(e[0],e[1])))))),A=v((()=>i[$.value]));v((()=>+($.value>0?i[$.value][1]-i[$.value-1][1]:0).toFixed(2)));const D=o(!1),R=v((()=>F.saved&&F.selled?{value:F.selled[1]-F.saved[1],perc:100*(F.selled[1]-F.saved[1])/F.saved[1]}:null));function U(e){e+1<F.steps?$.value=e+1:(D.value=!1,null==F.selled&&(F.selled=i[F.steps-1]))}const Y=o(null);function q(){D.value=!0,N()}function N(){U($.value),D.value&&setTimeout((()=>{N()}),1e3*M.value)}function G(){F.saved=i[$.value]}function H(){F.selled=i[$.value]}function J(e,a){const t=(j.width-35-0)/F.steps,s=(j.height-80-20)/(F.maxValue-F.minValue);return{x:0+e*t,y:j.height-40-a*s+F.minValue*s}}function K(){const{width:e,height:a}=Y.value.getBoundingClientRect();j.width=Math.round(e),j.height=Math.round(a)}return y((()=>{const{width:e,height:a}=Y.value.getBoundingClientRect();$.value=0,j.width=Math.round(e),j.height=Math.round(a),window.addEventListener("resize",K),h((()=>{q()}))})),p((()=>{window.removeEventListener("resize",K)})),(a,t)=>(c(),u(f,null,[x("div",L,[x("div",S,[m(A)||m(F).selled?(c(),u("div",P,b(m(F).selled?+m(F).selled[1].toFixed(2)+(n.currency?" "+n.currency:" ₽"):m(A)[1].toLocaleString()+(n.currency?" "+n.currency:" ₽")),1)):g("",!0)]),x("div",{ref:Y,class:"graph-container"},[(c(),u("svg",{class:"graph",width:m(j).width+10,height:m(j).height,viewBox:`${m(j).x} ${m(j).y} ${m(j).width+10} ${m(j).height}`,fill:"none",xmlns:"http://www.w3.org/2000/svg"},[x("path",{class:"axis",d:`M0 ${m(j).height}, ${m(j).width} ${m(j).height}`},null,8,["d"]),(c(!0),u(f,null,w(m(C),(e=>(c(),u(f,{key:e.value},[x("path",{class:"y-line",d:`M0 ${e.y}, ${m(j).width} ${e.y}`},null,8,["d"]),x("text",{x:"-25",y:e.y+4,class:"y-text"},b(Math.round(e.value)),9,["y"])],64)))),128)),x("path",{class:"axis",d:`M0 ${m(j).height}, 0 0`},null,8,["d"]),(c(!0),u(f,null,w(m(E),((e,a)=>(c(),u(f,{key:a},[x("circle",{cx:e.x,cy:e.y,r:"5",fill:"red",class:"point-circle"},null,8,["cx","cy"]),x("line",{x1:e.x,y1:e.y-30,x2:e.x,y2:m(j).height,stroke:"black"},null,8,["x1","y1","x2","y2"]),x("line",{x1:e.x-5,y1:e.y-30,x2:e.x+5,y2:e.y-30,stroke:"black"},null,8,["x1","y1","x2","y2"]),x("text",{"text-anchor":"end",x:e.x+8,y:e.y-40,class:"point-text"},b(e.value),9,["x","y"])],64)))),128)),(c(!0),u(f,null,w(m(O),((a,t)=>(c(),u("path",{class:["line-path",{visible:t<$.value}],key:t+"_"+e.id,ref:e=>{e&&(V.value[t]=e)},d:a,style:{"stroke-dasharray":m(_)[t],"stroke-dashoffset":m(_)[t],transition:`${m(M)}s`},stroke:"black"},null,14,["d"])))),128))],8,["width","height","viewBox"]))],512),T]),x("div",B,[x("div",I,[m(R)?(c(),u("div",z,[m(R)?(c(),u("div",{key:0,class:["current-diff",{up:m(R).value>0,down:m(R).value<0}]},[x("div",{class:["arrow",{up:m(R).value>0,down:m(R).value<0}]},null,2),k(" "+b(+Math.abs(m(R).value).toFixed(2))+" "+b(n.currency?" "+n.currency:" ₽")+" ("+b(+Math.abs(m(R).perc).toFixed(2))+"%) ",1)],2)):g("",!0)])):g("",!0),D.value||m(F).steps-1===$.value?g("",!0):(c(),u("button",{key:1,class:"button",onClick:q}," Начать ")),D.value&&!m(F).saved?(c(),u("button",{key:2,class:"button",onClick:G}," Купить ")):g("",!0),D.value&&m(F).saved&&!m(R)?(c(),u("button",{key:3,class:"button",style:{background:"#151D2A"},onClick:H}," Продать ")):g("",!0)])])],64))},__scopeId:"data-v-a5bb5464"};n("data-v-1463ccdc");const U={class:"app-container"},Y={class:"container"},q={key:0,class:"title-container"},N={class:"subtitle"},G={class:"container"};i();const H={expose:[],setup(e){const a=M(),t=d({points:[],duration:40,currency:"$"});let s=[[0,10],[10,30],[20,20],[30,50],[40,20]];s=new Array(365),s.fill([0,0]);let l=o(null);async function n(e){const a=await fetch(`data/${e}.json`).then((e=>e.json())),l=a.reduce(((e,a)=>{var t;return e[(t=new Date(a["<DATE>"]),(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())-Date.UTC(t.getFullYear(),0,0))/24/60/60/1e3)-1]=a["<CLOSE>"],e}),{});let n=a[0]["<CLOSE>"];t.points.push(...s.map(((e,a,t)=>{const s=null!=l[a]?l[a]:n;return n=s,[a,s]})))}async function i(){try{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();if(t.duration=e.time||40,console.log(t.duration),!Array.isArray(e.sources))return Promise.reject();if(l.value=e.sources.find((e=>e.file===a.params.id)),!l.value)return Promise.reject();t.currency=l.value.currency,await n(l.value.file)}catch(e){}}return $((()=>{i()})),j((()=>a.params.id),(e=>{t.points=[],h((()=>{i()}))})),(e,s)=>{const n=r("router-link");return c(),u("div",U,[x("header",{class:"header",style:{background:m(l)?m(l).color:void 0}},[x("div",Y,[x(n,{class:"back-btn",to:"/"}),m(l)?(c(),u("div",q,[x("div",null,b(m(l).title),1),x("div",N,b(m(l).short)+" "+b(m(l).year),1)])):g("",!0)])],4),x("div",G,[m(t).points&&m(t).points.length?(c(),u(R,{points:m(t).points,duration:m(t).duration,id:m(a).params.id,key:m(a).params.id,currency:m(t).currency},null,8,["points","duration","id","currency"])):g("",!0)])])}},__scopeId:"data-v-1463ccdc"};const J=C();n("data-v-e3a7462e");const K={class:"container"},Q=x("h1",{class:"h1"},"Выберите компанию",-1),W={key:0,class:"items"};i();const X={expose:[],setup(e){const a=d({items:[],isFullscreen:!1});function t(){F.isEnabled&&(a.isFullscreen=!F.isFullscreen,F.toggle())}return $((async()=>{const e=await async function(){try{return await fetch("data/settings.json").then((e=>e.json()))}catch(e){}}();a.items=e.sources})),(e,s)=>{const l=r("router-link");return c(),u("div",K,[x("button",{class:["fullscreen-icon",{off:m(a).isFullscreen}],onClick:t},null,2),Q,m(a).items?(c(),u("div",W,[(c(!0),u(f,null,w(m(a).items,(e=>(c(),u("div",{class:"item",style:{background:e.color},key:e.file},[x(l,{to:`/${e.file}`},{default:J((()=>[k(b(e.title)+" "+b(e.year),1)])),_:2},1032,["to"])],4)))),128))])):g("",!0)])}},__scopeId:"data-v-e3a7462e"},Z=O({routes:[{path:"",component:X},{path:"/:id",component:H}],history:_()}),ee=E(D);ee.use(Z),ee.mount("#app"),ee.use(A);
